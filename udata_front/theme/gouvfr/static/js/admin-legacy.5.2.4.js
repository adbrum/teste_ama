System.register(["vue","./sentry-legacy.5.2.4.js","vue-content-loader","./_commonjsHelpers-legacy.5.2.4.js"],(function(e,a){"use strict";var l,t,r,s,n,o,i,u,d,c,f,m,p,v,b,g,_,y,h,w,k,z,x,C,A,$,S,D,q,B,P,j,R,M,T,F,O,U,V,I,H,E,L,N,Y,W,J,Z,K,Q,X,G,ee,ae,le,te,re,se,ne,oe,ie,ue,de,ce,fe,me,pe,ve,be,ge,_e,ye,he,we,ke,ze,xe,Ce,Ae,$e,Se,De,qe,Be,Pe,je,Re,Me,Te,Fe,Oe,Ue,Ve,Ie,He,Ee,Le,Ne,Ye,We,Je,Ze,Ke,Qe,Xe,Ge;return{setters:[e=>{l=e.defineComponent,t=e.openBlock,r=e.createElementBlock,s=e.Fragment,n=e.createVNode,o=e.mergeProps,i=e.createElementVNode,u=e.toDisplayString,d=e.unref,c=e.renderSlot,f=e.normalizeClass,m=e.ref,p=e.onMounted,v=e.createBlock,b=e.withCtx,g=e.createCommentVNode,_=e.computed,y=e.createTextVNode,h=e.renderList,w=e.readonly,k=e.watchEffect,z=e.resolveComponent,x=e.watchPostEffect,C=e.Teleport,A=e.withModifiers,$=e.createApp},e=>{S=e.B,D=e.u,q=e.x,B=e.bw,P=e.F,j=e._,R=e.b,M=e.bx,T=e.e,F=e.aj,O=e.y,U=e.J,V=e.z,I=e.D,H=e.be,E=e.by,L=e.bz,N=e.at,Y=e.bi,W=e.bA,J=e.bB,Z=e.bC,K=e.bD,Q=e.ao,X=e.K,G=e.ab,ee=e.bE,ae=e.bF,le=e.b9,te=e.bG,re=e.bH,se=e.aV,ne=e.V,oe=e.a5,ie=e.aS,ue=e.bI,de=e.au,ce=e.X,fe=e.$,me=e.bJ,pe=e.bK,ve=e.aI,be=e.bL,ge=e.bM,_e=e.bN,ye=e.bO,he=e.bP,we=e.bQ,ke=e.bR,ze=e.bS,xe=e.bT,Ce=e.v,Ae=e.A,$e=e.bd,Se=e.bU,De=e.bV,qe=e.bg,Be=e.a,Pe=e.bW,je=e.bX,Re=e.bY,Me=e.bZ,Te=e.a6,Fe=e.b_,Oe=e.b$,Ue=e.c0,Ve=e.c1,Ie=e.c2,He=e.aq,Ee=e.bk,Le=e.bn,Ne=e.aU,Ye=e.bo,We=e.bq,Je=e.br,Ze=e.c3,Ke=e.c4,Qe=e.bs,Xe=e.bt,Ge=e.bu},null,null],execute:function(){const e={class:"fr-ml-1v fr-text--bold"},a=l({__name:"AvatarWithName",props:{user:{},size:{default:12}},setup:a=>(a,l)=>(t(),r(s,null,[n(S,o(a.$attrs,{user:a.user,size:a.size,rounded:!0}),null,16,["user","size"]),i("span",e,u(a.user.first_name)+" "+u(a.user.last_name),1)],64))}),ea=["aria-label"],aa={class:"fr-breadcrumb__list"},la={__name:"Breadcrumb",setup(e){const{t:a}=D();return(e,l)=>(t(),r("nav",{rol:"navigation","aria-label":d(a)("You're here:"),class:"fr-breadcrumb fr-mb-5v"},[i("ol",aa,[c(e.$slots,"default")])],8,ea))}},ta={class:"fr-text--sm fr-my-0"},ra={class:"fr-grid-row fr-grid-row--right not-enlarged"},sa=["href","title"],na=l({__name:"QualityScoreTooltipContent",props:{dataset:{}},setup(e){const{t:a}=D();return(e,l)=>(t(),r(s,null,[i("h5",ta,u(d(a)("Metadata quality:")),1),n(d(q),{passed:e.dataset.quality.dataset_description_quality,messagePassed:d(a)("Data description filled"),messageFailed:d(a)("Data description empty"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),n(d(q),{passed:e.dataset.quality.resources_documentation,messagePassed:d(a)("Files documented"),messageFailed:d(a)("Files documentation missing"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),n(d(q),{passed:e.dataset.quality.license,messagePassed:d(a)("License filled"),messageFailed:d(a)("No license set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),n(d(q),{passed:e.dataset.quality.update_frequency&&!!e.dataset.quality.update_fulfilled_in_time,messagePassed:d(a)("Update frequency followed"),messageFailed:e.dataset.quality.update_frequency?d(a)("Update frequency not followed"):d(a)("Update frequency not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),n(d(q),{passed:e.dataset.quality.has_open_format,messagePassed:d(a)("File formats are open"),messageFailed:d(a)("File formats are closed"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),n(d(q),{passed:e.dataset.quality.temporal_coverage,messagePassed:d(a)("Temporal coverage filled"),messageFailed:d(a)("Temporal coverage not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),n(d(q),{passed:e.dataset.quality.spatial,messagePassed:d(a)("Spatial coverage filled"),messageFailed:d(a)("Spatial coverage not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),n(d(q),{passed:e.dataset.quality.all_resources_available,messagePassed:d(a)("All files are available"),messageFailed:d(a)("Some files are unavailable"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),i("div",ra,[i("a",{href:d(B),target:"_blank",rel:"noopener",title:d(a)("Learn more about this indicator - opens a new window")},u(d(a)("Learn more about this indicator")),9,sa)])],64))}}),oa=l({__name:"AdminBadge",props:{type:{}},setup:e=>(e,a)=>(t(),r("p",{class:f(["fr-badge",{"fr-badge--blue-cumulus":"info"===e.type,"fr-badge--error fr-badge--no-icon":"error"===e.type,"fr-badge--warning fr-badge--no-icon":"warning"===e.type,"fr-badge--success fr-badge--no-icon":"success"===e.type}])},[c(e.$slots,"default")],2))}),ia=["aria-describedby"],ua=["id"],da=j(l({inheritAttrs:!1,__name:"AdminContentWithTooltip",setup(e){const a=P(),l=m(),n=m("");return p((()=>{l.value&&(n.value=l.value.textContent||"")})),(e,f)=>(t(),r(s,null,[i("p",o(e.$attrs,{"aria-describedby":d(a),ref_key:"contentRef",ref:l}),[c(e.$slots,"default",{},void 0,!0)],16,ia),i("span",{class:"fr-hidden-xl fr-tooltip fr-placement",id:d(a),role:"tooltip","aria-hidden":"true"},u(n.value),9,ua)],64))}}),[["__scopeId","data-v-d192f17a"]]),ca=l({__name:"AdminLoader",props:{scale:{default:4}},setup:e=>(R(M),(e,a)=>(t(),v(d(T),{name:"ri-loader-5-line",animation:"spin",scale:e.scale,fill:"var(--blue-cumulus-sun-368-moon-732)"},null,8,["scale"])))}),fa={class:"fr-table fr-mb-2w"},ma=l({__name:"AdminTable",props:{loading:{type:Boolean,default:!1}},setup:e=>(e,a)=>(t(),r("div",fa,[i("table",null,[c(e.$slots,"default",{},void 0,!0)]),e.loading?(t(),v(F,{key:0,class:"fr-p-4w text-align-center"},{default:b((()=>[n(ca)])),_:1})):g("",!0)]))}),pa=j(ma,[["__scopeId","data-v-cae574a4"]]),va={class:"fr-text--bold"},ba={key:1,class:"fr-grid-row fr-grid-row--middle justify-between"},ga=["title"],_a=j(l({__name:"AdminTableTh",props:{sorted:{}},emits:["sort"],setup(e,{emit:a}){const l=e,s=a,{t:n}=D(),o=_((()=>void 0!==l.sorted));function m(){return"desc"===l.sorted?s("sort","asc"):s("sort","desc")}return(e,a)=>(t(),r("th",va,[o.value?(t(),r("div",ba,[c(e.$slots,"default",{},void 0,!0),i("button",{class:f(["fr-ml-1w fr-btn fr-btn--sm fr-btn--tertiary-no-outline",{"fr-icon-arrow-down-line":!e.sorted||"asc"===e.sorted,"fr-icon-arrow-up-line":"desc"===e.sorted,"text-grey-500":e.sorted,"text-mention-grey":!e.sorted}]),onClick:m,title:d(n)("Sort")},u(d(n)("Sort")),11,ga)])):c(e.$slots,"default",{key:0},void 0,!0)]))}}),[["__scopeId","data-v-5acf0bf0"]]),ya=["aria-describedby"],ha=["id"],wa=l({__name:"Tooltip",setup(e){const a=P("tooltip");return(e,l)=>(t(),r(s,null,[i("p",o(e.$attrs,{"aria-describedby":d(a)}),[c(e.$slots,"default")],16,ya),i("span",{class:"fr-tooltip fr-placement",id:d(a),role:"tooltip","aria-hidden":"true"},[c(e.$slots,"tooltip")],8,ha)],64))}}),ka=["href"],za={class:"monospace"},xa={class:"monospace"},Ca={class:"monospace"},Aa={class:"monospace"},$a={class:"monospace"},Sa=l({__name:"AdminDatasetsTable",props:{datasets:{},loading:{type:Boolean},sortDirection:{},sortedBy:{}},emits:["sort"],setup(e,{emit:a}){const l=a,o=e,{t:c}=D();function f(e,a){l("sort",e,a)}function m(e){return o.sortedBy===e?o.sortDirection:null}function p(e){return Array.isArray(e.resources)?e.resources.length:e.resources.total}function g(e){return`${H}dataset/${e.id}/`}function _(e){return e.deleted?{label:c("Deleted"),type:"error"}:e.archived?{label:c("Archived"),type:"warning"}:e.private?{label:c("Private"),type:"default"}:{label:c("Public"),type:"info"}}return(e,a)=>(t(),v(pa,{loading:e.loading},{default:b((()=>[i("thead",null,[i("tr",null,[n(_a,{onSort:a[0]||(a[0]=e=>f("title",e)),sorted:m("title"),scope:"col"},{default:b((()=>[y(u(d(c)("Title of the dataset")),1)])),_:1},8,["sorted"]),n(_a,{scope:"col"},{default:b((()=>[y(u(d(c)("Status")),1)])),_:1}),n(_a,{onSort:a[1]||(a[1]=e=>f("created",e)),sorted:m("created"),scope:"col"},{default:b((()=>[y(u(d(c)("Created at")),1)])),_:1},8,["sorted"]),n(_a,{onSort:a[2]||(a[2]=e=>f("last_update",e)),sorted:m("last_update"),scope:"col"},{default:b((()=>[y(u(d(c)("Updated at")),1)])),_:1},8,["sorted"]),n(_a,{scope:"col"},{default:b((()=>[y(u(d(c)("Files")),1)])),_:1}),n(_a,{scope:"col"},{default:b((()=>[y(u(d(c)("Score")),1)])),_:1}),n(_a,{scope:"col"},{default:b((()=>[n(wa,null,{tooltip:b((()=>[y(u(d(c)("Discussions")),1)])),default:b((()=>[a[6]||(a[6]=i("span",{class:"fr-icon--sm fr-icon-chat-3-line","aria-hidden":"true"},null,-1))])),_:1})])),_:1}),n(_a,{onSort:a[3]||(a[3]=e=>f("views",e)),sorted:m("views"),scope:"col"},{default:b((()=>[n(wa,null,{tooltip:b((()=>[y(u(d(c)("Views")),1)])),default:b((()=>[a[7]||(a[7]=i("span",{class:"fr-icon--sm fr-icon-eye-line","aria-hidden":"true"},null,-1))])),_:1})])),_:1},8,["sorted"]),n(_a,{scope:"col"},{default:b((()=>[n(wa,null,{tooltip:b((()=>[y(u(d(c)("Downloads")),1)])),default:b((()=>[a[8]||(a[8]=i("span",{class:"fr-icon--sm fr-icon-download-line","aria-hidden":"true"},null,-1))])),_:1})])),_:1}),n(_a,{onSort:a[4]||(a[4]=e=>f("reuses",e)),sorted:m("reuses"),scope:"col"},{default:b((()=>[n(wa,null,{tooltip:b((()=>[y(u(d(c)("Reuses")),1)])),default:b((()=>[a[9]||(a[9]=i("span",{class:"fr-icon--sm fr-icon-line-chart-line","aria-hidden":"true"},null,-1))])),_:1})])),_:1},8,["sorted"]),n(_a,{onSort:a[5]||(a[5]=e=>f("followers",e)),sorted:m("followers"),scope:"col"},{default:b((()=>[n(wa,null,{tooltip:b((()=>[y(u(d(c)("Favorites")),1)])),default:b((()=>[a[10]||(a[10]=i("span",{class:"fr-icon--sm fr-icon-star-s-line","aria-hidden":"true"},null,-1))])),_:1})])),_:1},8,["sorted"])])]),i("tbody",null,[(t(!0),r(s,null,h(e.datasets,(e=>{var a;return t(),r("tr",{key:e.id},[i("td",null,[n(da,null,{default:b((()=>[i("a",{class:"fr-link fr-reset-link",href:g(e)},[n(d(O),{text:e.title,"auto-resize":!0,"max-lines":2},null,8,["text"])],8,ka)])),_:2},1024)]),i("td",null,[n(oa,{type:_(e).type},{default:b((()=>[y(u(_(e).label),1)])),_:2},1032,["type"])]),i("td",null,u(d(U)(e.created_at)),1),i("td",null,u(d(U)(e.last_modified)),1),i("td",null,u(p(e)),1),i("td",null,[n(wa,null,{tooltip:b((()=>[n(na,{dataset:e},null,8,["dataset"])])),default:b((()=>[n(d(V),{class:"w-100",score:e.quality.score},null,8,["score"])])),_:2},1024)]),i("td",za,u(d(I)(e.metrics.discussions)),1),i("td",xa,u(d(I)(e.metrics.views)),1),i("td",Ca,u(d(I)(null!==(a=e.metrics.resources_downloads)&&void 0!==a?a:0)),1),i("td",Aa,u(d(I)(e.metrics.reuses)),1),i("td",$a,u(d(I)(e.metrics.followers)),1)])})),128))])])),_:1},8,["loading"]))}}),Da=m(null);function qa(){return{currentOrganization:w(Da),setCurrentOrganization:e=>{Da.value=e}}}const Ba=["href"],Pa=["src","alt"],ja=l({__name:"AdminPublishButton",props:{type:{}},setup(e){const a=e,{t:l}=D(),s=_((()=>{switch(a.type){case"dataset":return L;case"harvester":return`${H}harvester/new/`;case"reuse":return E}}));return(e,a)=>(t(),r("a",{href:s.value,class:"fr-btn fr-icon-add-line fr-btn--icon-left"},[y(u(d(l)("Publish on"))+" ",1),i("img",{class:"fr-ml-1v",src:d("/_themes/gouvfr/assets/logotype-white.svg"),loading:"lazy",alt:d(N)},null,8,Pa)],8,Ba))}}),Ra={key:0},Ma={class:"fr-breadcrumb__link","aria-current":"page"},Ta={class:"fr-h3 fr-mb-5v"},Fa={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle"},Oa={class:"fr-col"},Ua={class:"subtitle subtitle--uppercase fr-m-0"},Va={key:0,class:"fr-col-auto fr-grid-row fr-grid-row--middle"},Ia=["href"],Ha={class:"text-align-center fr-py-1w"},Ea=["src"],La={class:"fr-text--bold fr-my-3v"},Na=l({__name:"Datasets",props:{oid:{}},setup(e){const{t:a}=D(),l=e,s=m([]),o=m(!1),c=m(1),f=m(10),p=m(0),h=m("created"),w=m("desc"),x=_((()=>`${"asc"===w.value?"":"-"}${h.value}`)),C=m(""),A=Y(C,G),{currentOrganization:$}=qa(),S=W();function q(e,a){h.value=e,w.value=a}return k((async()=>{o.value=!0,s.value=[];try{let e;if(l.oid)e=await J(l.oid,A.value,c.value,f.value,x.value);else{if(!S.value)return;e=await Z(S.value.id,A.value,c.value,f.value,x.value)}s.value=e.data,c.value=e.page,f.value=e.page_size,p.value=e.total}finally{o.value=!1}})),(e,l)=>{const m=z("router-link");return t(),r("div",null,[n(la,null,{default:b((()=>[i("li",null,[n(m,{class:"fr-breadcrumb__link",to:"/"},{default:b((()=>[y(u(d(a)("Administration")),1)])),_:1})]),d($)?(t(),r("li",Ra,[n(m,{class:"fr-breadcrumb__link",to:"/"},{default:b((()=>[y(u(d($).name),1)])),_:1})])):g("",!0),i("li",null,[i("a",Ma,u(d(a)("Datasets")),1)])])),_:1}),i("h1",Ta,u(d(a)("Datasets")),1),i("div",Fa,[i("div",Oa,[i("h2",Ua,u(d(a)("{n} datasets",p.value)),1)]),e.oid?(t(),r("div",Va,[i("div",null,[i("a",{href:d(K)(e.oid,p.value),class:"fr-btn fr-btn--sm fr-icon-download-line fr-btn--icon-left"},u(d(a)("Download catalog")),9,Ia)])])):g("",!0)]),o.value||p.value>0?(t(),v(Sa,{key:0,datasets:s.value,loading:o.value,"sort-direction":w.value,sortedBy:h.value,onSort:q},null,8,["datasets","loading","sort-direction","sortedBy"])):(t(),v(F,{key:1,class:"fr-my-2w"},{default:b((()=>[i("div",Ha,[i("img",{src:d(Q),alt:"",loading:"lazy"},null,8,Ea),i("p",La,u(d(a)("You haven't published a dataset yet")),1),n(ja,{type:"dataset"})])])),_:1})),p.value>f.value?(t(),v(d(X),{key:2,page:c.value,"page-size":f.value,"total-results":p.value,onChange:l[0]||(l[0]=e=>c.value=e)},null,8,["page","page-size","total-results"])):g("",!0)])}}}),Ya=["href"],Wa={class:"monospace"},Ja={class:"monospace"},Za={class:"monospace"},Ka={class:"monospace"},Qa=l({__name:"AdminReusesTable",props:{reuses:{},loading:{type:Boolean},sortedBy:{},sortDirection:{}},emits:["sort"],setup(e){const a=e,{t:l}=D();function o(e){return a.sortedBy===e?a.sortDirection:null}function c(e){return`${H}reuse/${e.id}/`}function f(e){return e.deleted?{label:l("Deleted"),type:"error"}:e.archived?{label:l("Archived"),type:"warning"}:e.private?{label:l("Private"),type:"default"}:{label:l("Public"),type:"info"}}return(e,a)=>(t(),v(pa,{loading:e.loading},{default:b((()=>[i("thead",null,[n(_a,{onSort:a[0]||(a[0]=a=>e.$emit("sort","title",a)),sorted:o("title"),scope:"col"},{default:b((()=>[y(u(d(l)("Reuse title")),1)])),_:1},8,["sorted"]),n(_a,null,{default:b((()=>[y(u(d(l)("Status")),1)])),_:1}),n(_a,{onSort:a[1]||(a[1]=a=>e.$emit("sort","created",a)),sorted:o("created"),scope:"col"},{default:b((()=>[y(u(d(l)("Created at")),1)])),_:1},8,["sorted"]),n(_a,{onSort:a[2]||(a[2]=a=>e.$emit("sort","datasets",a)),sorted:o("datasets"),scope:"col"},{default:b((()=>[y(u(d(l)("Datasets")),1)])),_:1},8,["sorted"]),n(_a,{scope:"col"},{default:b((()=>[n(wa,null,{tooltip:b((()=>[y(u(d(l)("Discussions")),1)])),default:b((()=>[a[5]||(a[5]=i("span",{class:"fr-icon--sm fr-icon-chat-3-line","aria-hidden":"true"},null,-1))])),_:1})])),_:1}),n(_a,{onSort:a[3]||(a[3]=a=>e.$emit("sort","views",a)),sorted:o("views"),scope:"col"},{default:b((()=>[n(wa,null,{tooltip:b((()=>[y(u(d(l)("Views")),1)])),default:b((()=>[a[6]||(a[6]=i("span",{class:"fr-icon--sm fr-icon-eye-line","aria-hidden":"true"},null,-1))])),_:1})])),_:1},8,["sorted"]),n(_a,{onSort:a[4]||(a[4]=a=>e.$emit("sort","followers",a)),sorted:o("followers"),scope:"col"},{default:b((()=>[n(wa,null,{tooltip:b((()=>[y(u(d(l)("Favorites")),1)])),default:b((()=>[a[7]||(a[7]=i("span",{class:"fr-icon--sm fr-icon-star-s-line","aria-hidden":"true"},null,-1))])),_:1})])),_:1},8,["sorted"])]),i("tbody",null,[(t(!0),r(s,null,h(e.reuses,(e=>(t(),r("tr",null,[i("td",null,[n(da,null,{default:b((()=>[i("a",{class:"fr-link fr-reset-link",href:c(e)},[n(d(O),{text:e.title,"auto-resize":!0,"max-lines":2},null,8,["text"])],8,Ya)])),_:2},1024)]),i("td",null,[n(oa,{type:f(e).type},{default:b((()=>[y(u(f(e).label),1)])),_:2},1032,["type"])]),i("td",null,u(d(U)(e.created_at)),1),i("td",Wa,u(d(I)(e.datasets.length)),1),i("td",Ja,u(d(I)(e.metrics.discussions)),1),i("td",Za,u(d(I)(e.metrics.views)),1),i("td",Ka,u(d(I)(e.metrics.followers)),1)])))),256))])])),_:1},8,["loading"]))}}),Xa={class:"fr-container--fluid"},Ga={key:0},el={class:"fr-breadcrumb__link","aria-current":"page"},al={class:"fr-h3 fr-mb-5v"},ll={class:"subtitle subtitle--uppercase fr-mb-0"},tl={class:"text-align-center fr-py-1w"},rl=["src"],sl={class:"fr-text--bold fr-my-3v"},nl=l({__name:"Reuses",props:{oid:{}},setup(e){const{t:a}=D(),l=e,s=m([]),o=m(!1),c=m(1),f=m(10),p=m(0),h=m("created"),w=m("desc"),x=_((()=>`${"asc"===w.value?"":"-"}${h.value}`)),{currentOrganization:C}=qa(),A=W();function $(e,a){h.value=e,w.value=a}return k((async()=>{o.value=!0,s.value=[];try{let e;if(l.oid)e=await ee(l.oid,c.value,f.value,x.value);else{if(!A.value)return;e=await ae(A.value.id,c.value,f.value,x.value)}s.value=e.data,c.value=e.page,f.value=e.page_size,p.value=e.total}finally{o.value=!1}})),(e,l)=>{const m=z("router-link");return t(),r("div",Xa,[n(la,null,{default:b((()=>[i("li",null,[n(m,{class:"fr-breadcrumb__link",to:"/"},{default:b((()=>[y(u(d(a)("Administration")),1)])),_:1})]),d(C)?(t(),r("li",Ga,[n(m,{class:"fr-breadcrumb__link",to:"/"},{default:b((()=>[y(u(d(C).name),1)])),_:1})])):g("",!0),i("li",null,[i("a",el,u(d(a)("Reuses")),1)])])),_:1}),i("h1",al,u(d(a)("Reuses")),1),i("h2",ll,u(d(a)("{n} reuses of your organization",s.value.length)),1),o.value||p.value>0?(t(),v(Qa,{key:0,reuses:s.value,loading:o.value,sortDirection:w.value,sortedBy:h.value,onSort:$},null,8,["reuses","loading","sortDirection","sortedBy"])):(t(),v(F,{key:1,class:"fr-mt-1w fr-mb-2w"},{default:b((()=>[i("div",tl,[i("img",{src:d("/_themes/gouvfr/assets/reuse.svg"),alt:"",loading:"lazy"},null,8,rl),i("p",sl,u(d(a)("You haven't published a reuse yet")),1),n(ja,{type:"reuse"})])])),_:1})),p.value>f.value?(t(),v(d(X),{key:2,page:c.value,"page-size":f.value,"total-results":p.value,onChange:l[0]||(l[0]=e=>c.value=e)},null,8,["page","page-size","total-results"])):g("",!0)])}}}),ol={class:"fr-breadcrumb__link","aria-current":"page"},il={key:0,class:"fr-h1"},ul={class:"fr-alert fr-alert--info"},dl={class:"fr-alert__title"},cl={href:"/admin/me/"},fl=l({__name:"Me",setup(e){const{t:a}=D(),l=W();return(e,s)=>{const o=z("router-link");return t(),r("div",null,[n(la,null,{default:b((()=>[i("li",null,[n(o,{class:"fr-breadcrumb__link",to:"/"},{default:b((()=>[y(u(d(a)("Administration")),1)])),_:1})]),i("li",null,[i("a",ol,u(d(a)("Me")),1)])])),_:1}),d(l)?(t(),r("h1",il,u(d(l).first_name)+" "+u(d(l).last_name),1)):g("",!0),i("div",ul,[i("h3",dl,u(d(a)("This is a WIP page")),1),i("p",null,[i("a",cl,u(d(a)("You can edit your profil on the current admin.")),1)])])])}}}),ml='<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M5 12V18C5 18 5 21 12 21C19 21 19 18 19 18V12" stroke="currentColor" stroke-width="1.5"/>\n<path d="M5 6V12C5 12 5 15 12 15C19 15 19 12 19 12V6" stroke="currentColor" stroke-width="1.5"/>\n<path d="M12 3C19 3 19 6 19 6C19 6 19 9 12 9C5 9 5 6 5 6C5 6 5 3 12 3Z" stroke="currentColor" stroke-width="1.5"/>\n</svg>\n',pl={class:"fr-sidemenu__item"},vl=["innerHTML"],bl=j(l({__name:"AdminSidebarLink",props:{label:{},icon:{},iconHtml:{},to:{}},setup:e=>(e,a)=>{const l=z("TextClamp"),s=z("router-link");return t(),r("li",pl,[i("div",{class:f([{"fr-icon-svg fr-icon--sm":e.iconHtml},"fr-enlarge-link fr-sidemenu__link fr-mb-1w"])},[e.iconHtml?(t(),r("div",{key:0,class:"fr-mr-1w fr-grid-row",innerHTML:e.iconHtml},null,8,vl)):e.icon?(t(),r("div",{key:1,class:f([e.icon,"fr-mr-1w fr-icon--sm"]),"aria-hidden":"true"},null,2)):g("",!0),n(s,{to:e.to},{default:b((()=>[n(l,{text:e.label,"auto-resize":!0,"max-lines":1},null,8,["text"])])),_:1},8,["to"])],2)])}}),[["__scopeId","data-v-65a3b831"]]),gl=["aria-expanded","aria-controls","aria-current"],_l={class:"fr-mx-1w"},yl={class:"logo logo--sm"},hl={class:"fr-mx-1w fr-col text-overflow-ellipsis"},wl=["id"],kl={class:"fr-sidemenu__list fr-mx-1w fr-my-3v"},zl=l({__name:"AdminSidebarMenu",props:{user:{},organization:{},isOpened:{type:Boolean}},emits:["open","click"],setup(e){const a=e,{t:l}=D(),o=P("menu");return x((()=>{setTimeout((()=>{!function(e,a){const l=document.getElementById(o);a(l)&&(e?a(l).collapse.disclose():a(l).collapse.conceal())}(a.isOpened,globalThis.dsfr)}),200)})),(e,a)=>(t(),r("li",{class:f(["fr-sidemenu__item",{"fr-sidemenu__item--active":e.isOpened}])},[i("button",{class:"fr-sidemenu__btn","aria-expanded":e.isOpened,"aria-controls":d(o),"aria-current":e.isOpened,onClick:a[0]||(a[0]=a=>e.$emit("open"))},[e.user?(t(),r(s,{key:0},[e.user?(t(),v(d(S),{key:0,user:e.user,size:24,rounded:!0},null,8,["user"])):g("",!0),i("p",_l,u(d(l)("My Profil")),1)],64)):e.organization?(t(),r(s,{key:1},[i("div",yl,[n(le,{type:"organization",src:e.organization.logo_thumbnail,size:20},null,8,["src"])]),i("p",hl,u(e.organization.name),1)],64)):g("",!0)],8,gl),i("div",{class:"fr-collapse","data-fr-js-collapse":"",id:d(o)},[i("ul",kl,[e.user?(t(),r(s,{key:0},[n(bl,{icon:"fr-icon-account-circle-line",label:d(l)("Me"),to:{name:"me"}},null,8,["label"]),n(bl,{iconHtml:d(ml),label:d(l)("Datasets"),to:{name:"me-datasets"}},null,8,["iconHtml","label"]),n(bl,{icon:"fr-icon-line-chart-line",label:d(l)("Reuses"),to:{name:"me-reuses"}},null,8,["label"]),n(bl,{icon:"fr-icon-git-pull-request-line",label:d(l)("Community Resources"),to:{name:"me-community-resources"}},null,8,["label"])],64)):e.organization?(t(),r(s,{key:1},[n(bl,{iconHtml:d(ml),label:d(l)("Datasets"),to:{name:"organization-datasets",params:{oid:e.organization.id}},onClick:a[1]||(a[1]=a=>e.$emit("click"))},null,8,["iconHtml","label","to"]),n(bl,{icon:"fr-icon-line-chart-line",label:d(l)("Reuses"),to:{name:"organization-reuses",params:{oid:e.organization.id}},onClick:a[2]||(a[2]=a=>e.$emit("click"))},null,8,["label","to"]),n(bl,{icon:"fr-icon-chat-3-line",label:d(l)("Discussions"),to:{name:"organization-discussions",params:{oid:e.organization.id}},onClick:a[3]||(a[3]=a=>e.$emit("click"))},null,8,["label","to"]),n(bl,{icon:"fr-icon-parent-line",label:d(l)("Members"),to:{name:"organization-members",params:{oid:e.organization.id}},onClick:a[4]||(a[4]=a=>e.$emit("click"))},null,8,["label","to"]),n(bl,{icon:"fr-icon-server-line",label:d(l)("Harvesters"),to:{name:"organization-harvesters",params:{oid:e.organization.id}},onClick:a[5]||(a[5]=a=>e.$emit("click"))},null,8,["label","to"]),n(bl,{icon:"fr-icon-git-pull-request-line",label:d(l)("Community Resources"),to:{name:"organization-community-resources",params:{oid:e.organization.id}},onClick:a[6]||(a[6]=a=>e.$emit("click"))},null,8,["label","to"]),n(bl,{icon:"fr-icon-user-line",label:d(l)("Profile"),to:{name:"organization-profile",params:{oid:e.organization.id}},onClick:a[7]||(a[7]=a=>e.$emit("click"))},null,8,["label","to"])],64)):g("",!0)])],8,wl)],2))}}),xl=j(zl,[["__scopeId","data-v-c097b9c2"]]),Cl={class:"fr-container--fluid h-100"},Al={class:"fr-grid-row h-100 bg-grey-50"},$l={class:"fr-col-12 fr-col-md-4 fr-col-lg-3 fr-col-xl-2"},Sl=["aria-label"],Dl={class:"fr-sidemenu__inner"},ql=["aria-controls"],Bl=["id"],Pl={class:"fr-sidemenu__list"},jl={class:"fr-col-12 fr-col-md-8 fr-col-lg-9 fr-col-xl-10 h-100 fr-px-2w overflow-auto"},Rl=l({__name:"Admin",setup(e){const{t:a}=D(),l=te(),n=P("menu"),o=m(null),c=m(),{setCurrentOrganization:f}=qa(),b=re();function _(e){return e===c.value}function y(e){c.value=e.id}return p((async()=>{var e;if(o.value=await se(),l.name||(o.value.organizations.length>0?b.replace({name:"organization-datasets",params:{oid:o.value.organizations[0].id}}):b.replace({name:"me"})),"me"===l.name)c.value=null===(e=ne)||void 0===e?void 0:e.id;else if(o.value.organizations.length>0){let e=o.value.organizations[0];var a;l.params.oid&&(e=null!==(a=o.value.organizations.find((e=>e.id===l.params.oid)))&&void 0!==a?a:e),y(e),f(e)}})),(e,c)=>{const m=z("router-view");return t(),r("div",Cl,[i("div",Al,[i("div",$l,[i("nav",{class:"fr-sidemenu fr-pr-0","aria-label":d(a)("Administration menu")},[i("div",Dl,[i("button",{class:"fr-sidemenu__btn",hidden:"","aria-controls":d(n),"aria-expanded":"false"},u(d(a)("Open menu")),9,ql),i("div",{class:"fr-collapse",id:d(n)},[i("ul",Pl,[d(ne)?(t(),v(xl,{key:0,user:d(ne),"is-opened":_(d(ne).id),onOpen:c[0]||(c[0]=e=>y(d(ne)))},null,8,["user","is-opened"])):g("",!0),o.value?(t(!0),r(s,{key:1},h(o.value.organizations,(e=>(t(),v(xl,{organization:e,"is-opened":_(e.id),onOpen:()=>y(e),onClick:()=>d(f)(e)},null,8,["organization","is-opened","onOpen","onClick"])))),256)):g("",!0)])],8,Bl)])],8,Sl)]),i("div",jl,[(t(),v(m,{key:d(l).fullPath,class:"fr-container--fluid"}))])])])}}}),Ml=j(Rl,[["__scopeId","data-v-364348c3"]]),Tl=["aria-labelledby","id"],Fl={class:"fr-container fr-container--fluid fr-container-md"},Ol={class:"fr-grid-row fr-grid-row--center"},Ul={class:"fr-col-12 fr-col-md-8"},Vl={class:"fr-modal__body"},Il={class:"fr-modal__header"},Hl=["title","aria-controls"],El={class:"fr-modal__content"},Ll=["id"],Nl={class:"fr-modal__footer"},Yl={class:"fr-btns-group fr-btns-group--right fr-btns-group--sm fr-btns-group--inline-lg fr-btns-group--icon-left"},Wl=["disabled"],Jl=["disabled"],Zl=l({__name:"AdminAddMemberModal",props:{id:{},oid:{},roles:{}},emits:["memberAdded"],setup(e,{emit:a}){const l=e,r=a,{t:s}=D(),{toast:o}=ce(),c=m(!1),f=m(),p=m("editor"),b=_((()=>"fr-modal-title-user-"+l.id));async function y(){try{c.value=!0,f.value&&(await ue(l.oid,f.value,p.value),r("memberAdded"),w())}catch(e){o.error(s("An error occurred while update member role."))}finally{c.value=!1}}function h(e){return e.map((e=>{var a;const l={...e,avatar_thumbnail:null!==(a=e.avatar_url)&&void 0!==a?a:void 0};return{value:l.id,label:l.first_name+" "+l.last_name,image:de(l,32)}}))}function w(){c.value=!1,f.value=void 0,p.value="editor";const e=document.getElementById(l.id);globalThis.dsfr(e).modal.conceal()}return(e,a)=>(t(),v(C,{to:"body"},[i("dialog",{"aria-labelledby":b.value,role:"dialog",id:e.id,class:"fr-modal"},[i("div",Fl,[i("div",Ol,[i("div",Ul,[i("div",Vl,[i("div",Il,[i("button",{class:"fr-btn--close fr-btn",title:d(s)("Close the modal dialog"),"aria-controls":e.id},u(d(s)("Close")),9,Hl)]),i("form",{onSubmit:A(y,["prevent"])},[i("div",El,[i("h1",{id:b.value,class:"fr-modal__title fr-mb-2w"},u(d(s)("Add member to the organization")),9,Ll),n(oe,{placeholder:e.$t("Search a user"),searchPlaceholder:e.$t("Search a user..."),suggestUrl:"/users/suggest/",values:f.value,onChange:a[0]||(a[0]=e=>f.value=e),allOption:e.$t("Select a user"),addAllOption:!1,onSuggest:h,roundedImages:!0},null,8,["placeholder","searchPlaceholder","values","allOption"]),e.roles.length>0?(t(),v(ie,{key:0,label:d(s)("Role of the member"),"model-value":p.value,"onUpdate:modelValue":a[1]||(a[1]=e=>p.value=e),options:e.roles},null,8,["label","model-value","options"])):g("",!0)]),i("div",Nl,[i("div",Yl,[i("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500",type:"button",onClick:w,disabled:c.value},u(d(s)("Cancel")),9,Wl),i("button",{class:"fr-btn",type:"submit",disabled:c.value},u(d(s)("Add to the organization")),9,Jl)])])],32)])])])])],8,Tl)]))}}),Kl=["aria-controls"],Ql=l({__name:"AdminAddMemberButton",props:{oid:{},roles:{}},emits:["memberAdded"],setup(e){const a=e,{t:l}=D(),o=_((()=>"fr-modal-add-user-"+a.oid));return(e,a)=>(t(),r(s,null,[i("button",{class:"fr-btn fr-btn--sm fr-btn--icon-left fr-icon-add-line","data-fr-opened":"false","aria-controls":o.value},u(d(l)("Add member")),9,Kl),n(Zl,{id:o.value,oid:e.oid,roles:e.roles,onMemberAdded:a[0]||(a[0]=a=>e.$emit("memberAdded"))},null,8,["id","oid","roles"])],64))}}),Xl={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle"},Gl=l({__name:"AdminDangerZone",setup:e=>(e,a)=>(t(),v(d(fe),{color:"error",type:"secondary",weight:"regular"},{default:b((()=>[i("div",Xl,[c(e.$slots,"default")])])),_:3}))}),et={class:"fr-px-1v rounded-2 monospace fr-text--sm text-mention-grey bg-grey-100 fr-m-0"},at=l({__name:"AdminEmail",props:{email:{}},setup:e=>(e,a)=>(t(),r("p",et,u(e.email),1))}),lt=["aria-labelledby","id"],tt={class:"fr-container fr-container--fluid fr-container-md"},rt={class:"fr-grid-row fr-grid-row--center"},st={class:"fr-col-12 fr-col-md-8"},nt={class:"fr-modal__body"},ot={class:"fr-modal__header"},it=["title","aria-controls"],ut={class:"fr-modal__content"},dt=["id"],ct={class:"fr-grid-row fr-grid-row--middle fr-mb-2w"},ft={class:"fr-text--bold fr-m-0 fr-mr-1v"},mt={class:"fr-col"},pt={class:"fr-col-auto"},vt=["disabled"],bt={class:"fr-col"},gt={class:"fr-m-0 text-grey-500"},_t={class:"fr-m-0 fr-text--xs text-default-error"},yt={class:"fr-col-auto"},ht=["disabled"],wt=l({__name:"AdminEditMemberModal",props:{id:{},member:{},oid:{},roles:{}},emits:["memberUpdated"],setup(e,{emit:a}){const l=e,r=a,s=_((()=>"fr-modal-title-user-"+l.id)),{t:o}=D(),{toast:c}=ce(),f=m(!1);function p(){f.value=!1;const e=document.getElementById(l.id);globalThis.dsfr(e).modal.conceal()}return(e,a)=>{return t(),v(C,{to:"body"},[i("dialog",{"aria-labelledby":s.value,role:"dialog",id:e.id,class:"fr-modal"},[i("div",tt,[i("div",rt,[i("div",st,[i("div",nt,[i("div",ot,[i("button",{class:"fr-btn--close fr-btn",title:d(o)("Close the modal dialog"),"aria-controls":e.id},u(d(o)("Close")),9,it)]),i("div",ut,[i("h1",{id:s.value,class:"fr-modal__title fr-mb-2w"},u(d(o)("Edit member")),9,dt),i("div",ct,[n(d(S),{class:"fr-mr-1v",user:e.member.user,rounded:!0,size:24},null,8,["user"]),i("p",ft,u(e.member.user.first_name)+" "+u(e.member.user.last_name),1),e.member.user.email?(t(),v(at,{key:0,email:e.member.user.email},null,8,["email"])):g("",!0)]),i("form",{class:"fr-grid-row fr-grid-row--gutters fr-grid-row--bottom",onSubmit:a[1]||(a[1]=A((a=>async function(e){if(e.newRole)try{f.value=!0,await me(l.oid,e.user.id,e.newRole),r("memberUpdated"),p()}catch(a){c.error(o("An error occurred while update member role."))}finally{f.value=!1}else p()}(e.member)),["prevent"]))},[i("div",mt,[e.roles.length>0?(t(),v(ie,{key:0,label:d(o)("Role of the member"),"model-value":e.member.role,"onUpdate:modelValue":a[0]||(a[0]=a=>e.member.newRole=a),options:(m=e.member.role,l.roles.map((e=>{const a={...e};return a.value===m&&(a.selected=!0),a})))},null,8,["label","model-value","options"])):g("",!0)]),i("div",pt,[i("button",{class:"fr-btn",type:"submit",disabled:f.value},u(d(o)("Validate")),9,vt)])],32),n(Gl,{class:"fr-mt-2w"},{default:b((()=>[i("div",bt,[i("p",gt,u(d(o)("Remove member from the organization")),1),i("p",_t,u(d(o)("Be careful, this action can't be reverse.")),1)]),i("div",yt,[i("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary--error fr-btn--icon-left fr-icon-logout-box-r-line",disabled:f.value,onClick:a[2]||(a[2]=a=>async function(e){try{f.value=!0,await pe(l.oid,e.user.id),r("memberUpdated")}catch(a){c.error(o("An error occurred while removing this member."))}finally{f.value=!1}}(e.member))},u(d(o)("Remove member")),9,ht)])])),_:1})])])])])])],8,lt)]);var m}}}),kt=["aria-controls"],zt=l({__name:"AdminEditMemberButton",props:{member:{},oid:{},roles:{}},emits:["memberUpdated"],setup(e){const a=e,{t:l}=D(),o=_((()=>"fr-modal-user-"+a.member.user.id));return(e,a)=>(t(),r(s,null,[i("button",{class:"fr-btn fr-btn--sm fr-btn--secondary-grey-500 fr-btn--tertiary-no-outline fr-icon-pencil-line","data-fr-opened":"false","aria-controls":o.value},u(d(l)("Edit")),9,kt),n(wt,{id:o.value,member:e.member,oid:e.oid,roles:e.roles,onMemberUpdated:a[0]||(a[0]=a=>e.$emit("memberUpdated"))},null,8,["id","member","oid","roles"])],64))}}),xt={class:"fr-mt-n9v fr-mb-2w"},Ct={class:"fr-badge fr-badge--info fr-badge--no-icon"},At={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle"},$t={class:"fr-col"},St={class:"fr-grid-row fr-grid-row--middle"},Dt={class:"fr-text--bold fr-m-0 fr-mr-1v"},qt={class:"fr-m-0"},Bt={class:"fr-ml-3v fr-mt-1-5v fr-mb-0 filet filet-default-grey fr-text--sm"},Pt={key:0,class:"fr-col-auto fr-grid-row flex-direction-column"},jt=["disabled"],Rt=["disabled","aria-controls"],Mt=["aria-labelledby","id"],Tt={class:"fr-container fr-container--fluid fr-container-md"},Ft={class:"fr-grid-row fr-grid-row--center"},Ot={class:"fr-col-12 fr-col-md-8"},Ut={class:"fr-modal__body"},Vt={class:"fr-modal__header"},It=["title","aria-controls"],Ht={class:"fr-modal__content"},Et=["id"],Lt={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--right"},Nt={class:"fr-col-auto"},Yt=["disabled"],Wt={class:"fr-col-auto"},Jt=["disabled"],Zt=l({__name:"AdminMembershipRequest",props:{loading:{type:Boolean},oid:{},request:{},showActions:{type:Boolean}},emits:["accept","refuse"],setup(e,{emit:a}){const l=e,s=a,{t:o}=D(),c=m(""),f=P("modal"),p=P("modalTitle");function _(){const e=document.getElementById(f);globalThis.dsfr(e).modal.conceal()}function h(){s("refuse",l.request.id,c.value),_()}function w(){c.value="",_()}return(e,a)=>{const l=z("AdminMembershipRequest",!0);return t(),v(F,{class:"drop-shadow rounded-xxs fr-mt-3w"},{default:b((()=>[i("div",xt,[i("p",Ct,[a[2]||(a[2]=i("span",{class:"fr-icon-user-add-line fr-icon--sm","aria-hidden":"true"},null,-1)),y(" "+u(d(o)("Membership Request")),1)])]),i("div",At,[i("div",$t,[i("div",St,[n(d(S),{class:"fr-mr-1v",user:e.request.user,rounded:!0,size:24},null,8,["user"]),i("p",Dt,u(e.request.user.first_name)+" "+u(e.request.user.last_name),1),e.request.user.email?(t(),v(at,{key:0,email:e.request.user.email,class:"fr-mr-1v"},null,8,["email"])):g("",!0),i("p",qt,u(d(o)("asks to join the organization.")),1)]),i("div",Bt,u(e.request.comment),1)]),e.showActions?(t(),r("div",Pt,[i("button",{class:"fr-btn fr-btn--sm fr-btn--icon-left fr-mb-1w fr-icon-check-line",onClick:a[0]||(a[0]=a=>e.$emit("accept",e.request.id)),disabled:e.loading,"data-testid":"accept"},u(d(o)("Accept request")),9,jt),i("button",{class:"fr-btn fr-btn--icon-left fr-btn--sm fr-btn--secondary fr-btn--secondary--error fr-icon-close-line",disabled:e.loading,"data-fr-opened":"false","aria-controls":d(f),"data-testid":"refuse"},u(d(o)("Refuse")),9,Rt),(t(),v(C,{to:"body"},[i("dialog",{"aria-labelledby":d(p),role:"dialog",id:d(f),class:"fr-modal","data-testid":"modal"},[i("div",Tt,[i("div",Ft,[i("div",Ot,[i("div",Ut,[i("div",Vt,[i("button",{class:"fr-btn--close fr-btn",title:d(o)("Close the modal dialog"),"aria-controls":d(f),onClick:A(w,["prevent"])},u(d(o)("Close")),9,It)]),i("div",Ht,[i("h1",{id:d(p),class:"fr-modal__title fr-mb-2w"},u(d(o)("Refuse membership request")),9,Et),n(l,{class:"fr-mt-4w fr-mb-2w",loading:!1,oid:e.oid,request:e.request,"show-actions":!1},null,8,["oid","request"]),i("form",{onSubmit:A(h,["prevent"]),onReset:w},[n(ve,{label:d(o)("You can provide the refusal reason:"),modelValue:c.value,"onUpdate:modelValue":a[1]||(a[1]=e=>c.value=e),"data-testid":"comment-group"},null,8,["label","modelValue"]),i("div",Lt,[i("div",Nt,[i("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500",type:"reset",disabled:e.loading,"data-testid":"cancel-modal-button"},u(d(o)("Cancel")),9,Yt)]),i("div",Wt,[i("button",{class:"fr-btn",type:"submit",disabled:e.loading,"data-testid":"refuse-modal-button"},u(d(o)("Refuse request")),9,Jt)])])],32)])])])])])],8,Mt)]))])):g("",!0)])])),_:1})}}}),Kt={key:0},Qt={class:"fr-breadcrumb__link","aria-current":"page"},Xt={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle justify-center"},Gt={class:"fr-col-12 fr-col-md"},er={class:"fr-h3 fr-mb-0"},ar={key:0,class:"fr-col-auto"},lr={class:"subtitle subtitle--uppercase fr-mt-5v fr-mb-0"},tr={class:"fr-text--bold fr-m-0"},rr={class:"fr-m-0 fr-text--xs text-mention-grey f-italic inline-flex items-center"},sr={key:0},nr={key:1},or={key:0},ir=l({__name:"Members",props:{oid:{}},setup(e){const a=e;R(be);const{t:l}=D(),{toast:o}=ce(),c=m([]),w=_((()=>ge||A.value.some((e=>{var a;return e.user.id===(null===(a=ne)||void 0===a?void 0:a.id)&&"admin"===e.role})))),x=m([]),{currentOrganization:C}=qa(),A=m([]),$=m(!1);function S(e){var a,l;return null!==(a=null===(l=x.value.find((a=>a.value===e)))||void 0===l?void 0:l.label)&&void 0!==a?a:e}async function q(){$.value=!0,A.value=[];try{const e=await ke(a.oid);A.value=e.members}finally{$.value=!1}}async function B(){const e=await _e(a.oid);c.value=e}async function P(e){$.value=!0;const t=[];try{await ze(a.oid,e),t.push(B()),t.push(q())}catch(r){o.error(l("An error occurred while accepting this membership."))}finally{Promise.all(t).finally((()=>$.value=!1))}}async function j(e,t){$.value=!0;const r=[];try{await xe(a.oid,e,t),r.push(B()),r.push(q())}catch(s){o.error(l("An error occurred while refusing this membership."))}finally{Promise.all(r).finally((()=>$.value=!1))}}return k((()=>{w.value&&_e(a.oid).then((e=>c.value=e))})),p((()=>{ye().then(he).then((e=>x.value=e)),q()})),(e,a)=>{const o=z("router-link"),m=z("TextClamp");return t(),r("div",null,[n(la,null,{default:b((()=>[i("li",null,[n(o,{class:"fr-breadcrumb__link",to:"/"},{default:b((()=>[y(u(d(l)("Administration")),1)])),_:1})]),d(C)?(t(),r("li",Kt,[n(o,{class:"fr-breadcrumb__link",to:"/"},{default:b((()=>[y(u(d(C).name),1)])),_:1})])):g("",!0),i("li",null,[i("a",Qt,u(d(l)("Members")),1)])])),_:1}),i("div",Xt,[i("div",Gt,[i("h1",er,u(d(l)("Members")),1)]),w.value?(t(),r("div",ar,[n(Ql,{oid:e.oid,roles:x.value,onMemberAdded:q},null,8,["oid","roles"])])):g("",!0)]),c.value.length?(t(),r(s,{key:0},[i("h2",lr,u(d(l)("{n} requests",{n:c.value.length})),1),(t(!0),r(s,null,h(c.value,(a=>(t(),v(Zt,{class:"fr-mb-4w",key:a.id,loading:$.value,oid:e.oid,request:a,"show-actions":!0,onAccept:P,onRefuse:j},null,8,["loading","oid","request"])))),128))],64)):g("",!0),i("h2",{class:f(["subtitle subtitle--uppercase fr-mb-0",{"fr-mt-n3v":c.value.length,"fr-mt-5v":!c.value.length}])},u(d(l)("{n} members",{n:A.value.length})),3),n(pa,{class:"fr-table--layout-fixed",loading:$.value},{default:b((()=>[i("thead",null,[i("tr",null,[n(_a,{scope:"col"},{default:b((()=>[y(u(d(l)("Members")),1)])),_:1}),n(_a,{scope:"col"},{default:b((()=>[y(u(d(l)("Status")),1)])),_:1}),n(_a,{scope:"col"},{default:b((()=>[y(u(d(l)("Member since")),1)])),_:1}),n(_a,{scope:"col"},{default:b((()=>[y(u(d(l)("Last connection")),1)])),_:1}),w.value?(t(),v(_a,{key:0,scope:"col"},{default:b((()=>[y(u(d(l)("Action")),1)])),_:1})):g("",!0)])]),i("tbody",null,[(t(!0),r(s,null,h(A.value,(a=>{return t(),r("tr",{key:a.user.id},[i("td",null,[i("p",tr,u(a.user.first_name)+" "+u(a.user.last_name),1),i("p",rr,[n(d(T),{height:12,width:12,name:"ri-mail-line"}),n(wa,null,{default:b((()=>[n(m,{class:"fr-px-1v",text:a.user.email,"auto-resize":!0,"max-lines":1},null,8,["text"])])),_:2},1024)])]),i("td",null,[n(oa,{type:(s=a.role,"admin"===s?"info":"default")},{default:b((()=>[y(u(S(a.role)),1)])),_:2},1032,["type"])]),i("td",null,u(d(U)(a.since)),1),i("td",null,[a.user.last_login_at?(t(),r("span",sr,u(d(we)(a.user.last_login_at)),1)):(t(),r("span",nr,u(d(l)("No connection")),1))]),w.value?(t(),r("td",or,[n(zt,{member:a,oid:e.oid,roles:x.value,onMemberUpdated:q},null,8,["member","oid","roles"])])):g("",!0)]);var s})),128))])])),_:1},8,["loading"])])}}}),ur={class:"fr-container--fluid"},dr={key:0},cr={class:"fr-breadcrumb__link","aria-current":"page"},fr={class:"fr-h3 fr-mb-5v"},mr={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle justify-between"},pr={class:"fr-col-12 fr-col-md fr-grid-row fr-grid-row--middle"},vr={class:"fr-ml-3v fr-my-0 fr-h3"},br=["title"],gr={class:"fr-col-auto"},_r=["href"],yr=["id"],hr=["disabled","onClick"],wr={class:"fr-col"},kr={class:"fr-m-0 text-grey-500"},zr={class:"fr-m-0 fr-text--xs text-default-error"},xr={class:"fr-col-auto"},Cr=["disabled","aria-controls"],Ar=["aria-labelledby","id"],$r={class:"fr-container fr-container--fluid fr-container-md"},Sr={class:"fr-grid-row fr-grid-row--center"},Dr={class:"fr-col-12 fr-col-md-8"},qr={class:"fr-modal__body"},Br={class:"fr-modal__header"},Pr=["title","aria-controls"],jr={class:"fr-modal__content"},Rr=["id"],Mr={class:"fr-text--bold"},Tr={class:"fr-modal__footer"},Fr={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-reverse fr-btns-group--inline-lg fr-btns-group--icon-left"},Or=["disabled"],Ur=l({__name:"Profile",props:{oid:{}},setup(e){const{t:a}=D(),{toast:l}=ce(),s=e,o=re(),c=m(null),{currentOrganization:f}=qa(),_=m(null),{organizationCertified:h}=Ce(_),w=m([]),k=m(!1),x=P("modal"),A=P("modalTitle");function $(){f.value&&(k.value=!0,Se(f.value.id).then((()=>{o.replace("/"),window.location.reload()})).catch((()=>l.error(a("An error occured when deleting the organization.")))).finally((()=>k.value=!1)))}async function S(e,t){k.value=!0;try{_.value=await De(e),l.success(a("Organization updated !"))}catch(r){l.error(a("An error occured when updating the organization."))}finally{k.value=!1}if(t&&_.value){k.value=!0;try{const e=await qe(_.value.id,t);_.value.logo_thumbnail=e.image}catch(r){l.error(a("Failed to upload logo, you can upload it again in your management panel"))}finally{k.value=!1}}}return p((async()=>{k.value=!0;try{_.value=await ke(s.oid)}finally{k.value=!1}})),(e,l)=>{const s=z("router-link");return t(),r("div",ur,[n(la,null,{default:b((()=>[i("li",null,[n(s,{class:"fr-breadcrumb__link",to:"/"},{default:b((()=>[y(u(d(a)("Administration")),1)])),_:1})]),d(f)?(t(),r("li",dr,[n(s,{class:"fr-breadcrumb__link",to:"/"},{default:b((()=>[y(u(d(f).name),1)])),_:1})])):g("",!0),i("li",null,[i("a",cr,u(d(a)("Profile")),1)])])),_:1}),i("h1",fr,u(d(a)("Profile")),1),_.value?(t(),v(F,{key:0,class:"fr-mb-5v"},{default:b((()=>[i("div",mr,[i("div",pr,[n(d(Ae),{src:_.value.logo,type:"organization",size:80,class:"rounded-xxs border"},null,8,["src"]),i("div",vr,[y(u(_.value.name)+" ",1),d(h)?(t(),r("span",{key:0,class:"fr-icon-success-line fr-icon--lg text-blue-400",title:d(a)("The identity of this public service is certified by {certifier}",{certifier:d(N)}),"aria-hidden":"true"},null,8,br)):g("",!0)])]),i("div",gr,[i("a",{href:_.value.page,class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 fr-btn--icon-left fr-icon-eye-line"},u(d(a)("See the organization page")),9,_r)])])])),_:1})):g("",!0),c.value?(t(),r("h2",{key:1,class:"subtitle subtitle--uppercase fr-mb-5v",id:c.value.legend},u(d(a)("Edit profile")),9,yr)):g("",!0),k.value&&!_.value?(t(),v(ca,{key:2})):g("",!0),_.value?(t(),v($e,{key:3,organization:_.value,errors:w.value,showLegend:!1,showWell:!1,ref_key:"form",ref:c,onSubmit:S},{submitButton:b((({submit:e})=>[i("button",{class:"fr-btn fr-btn--icon-left fr-icon-save-line",disabled:k.value,"data-testid":"submitButton",onClick:e},u(d(a)("Save")),9,hr)])),default:b((()=>[n(Gl,{class:"fr-mt-6w"},{default:b((()=>[i("div",wr,[i("p",kr,u(d(a)("Delete the organization")),1),i("p",zr,u(d(a)("Be careful, this action can't be reverse.")),1)]),i("div",xr,[i("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary--error fr-btn--icon-left fr-icon-delete-line",disabled:k.value,"data-fr-opened":"false","aria-controls":d(x)},u(d(a)("Delete")),9,Cr),(t(),v(C,{to:"body"},[i("dialog",{"aria-labelledby":d(A),role:"dialog",id:d(x),class:"fr-modal"},[i("div",$r,[i("div",Sr,[i("div",Dr,[i("div",qr,[i("div",Br,[i("button",{class:"fr-btn--close fr-btn",title:d(a)("Close the modal dialog"),"aria-controls":d(x)},u(d(a)("Close")),9,Pr)]),i("div",jr,[i("h1",{id:d(A),class:"fr-modal__title fr-mb-2w"},u(d(a)("Are you sure you want to delete this organization ?")),9,Rr),i("p",Mr,u(d(a)("This action can't be reverse.")),1),i("p",null,u(d(a)("All content published with this organization will stay online, with the same URL but in an anonymous form, i.e. without being linked to a data producer.")),1),i("p",null,u(d(a)("If you want to delete your published content too, start by deleting the contents before deleting your account.")),1)]),i("div",Tr,[i("div",Fr,[i("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary--error",role:"button",disabled:k.value,onClick:$},u(d(a)("Delete")),9,Or)])])])])])])],8,Ar)]))])])),_:1})])),_:1},8,["organization","errors"])):g("",!0)])}}});async function Vr(e){switch(e.class){case"Dataservice":return async function(e){return(await Be.get(`dataservices/${e}/`)).data}(e.id);case"Dataset":return Oe(e.id);case"Post":return async function(e){return(await Be.get(`posts/${e}/`)).data}(e.id);case"Reuse":return Fe(e.id);default:return null}}function Ir(e,a){return null===e?null:{title:Hr(e),icon:Lr(a),page:Er(e)}}function Hr(e){return null===e?"":"title"in e?e.title:"headline"in e?e.headline:Ue(e,`Unknown type ${e}`)}function Er(e){return null===e?"":"page"in e?e.page:"self_web_url"in e?e.self_web_url:Ue(e,`Unknown type ${e}`)}function Lr(e){switch(e){case"Dataservice":return"ri-terminal-line";case"Dataset":return"ri-database-2-line";case"Post":return"ri-article-line";case"Reuse":return"ri-line-chart-line";default:return""}}R(Me,Re,je,Pe);const Nr={class:"fr-text--bold"},Yr={key:0},Wr=["href"],Jr={class:"inline-flex items-center"},Zr=["href"],Kr=l({__name:"AdminDiscussionsTable",props:{discussions:{},loading:{type:Boolean},sortDirection:{},sortedBy:{}},emits:["sort"],setup(e){const l=e,{t:o}=D(),c=m({}),f=m({});function p(e,a){return a?a.page+"#/discussions/"+e:""}function _(e){return l.sortedBy===e?l.sortDirection:null}function w(e){return e.discussion.slice(-1)[0]}return k((async()=>{for(const e of l.discussions)if(!(e.subject.id in c.value)){const a=Vr(e.subject);c.value[e.subject.id]=a;const l=await c.value[e.subject.id];f.value[e.subject.id]=Ir(l,e.subject.class)}})),(e,l)=>(t(),v(pa,{class:"fr-table--layout-fixed",loading:e.loading},{default:b((()=>[i("thead",null,[n(_a,{onSort:l[0]||(l[0]=a=>e.$emit("sort","title",a)),sorted:_("title"),scope:"col"},{default:b((()=>[y(u(d(o)("Discussion")),1)])),_:1},8,["sorted"]),n(_a,{scope:"col"},{default:b((()=>[y(u(d(o)("Number of comments")),1)])),_:1}),n(_a,{scope:"col"},{default:b((()=>[y(u(d(o)("Last comment")),1)])),_:1}),n(_a,{onSort:l[1]||(l[1]=a=>e.$emit("sort","closed",a)),sorted:_("closed"),scope:"col"},{default:b((()=>[y(u(d(o)("Closed at")),1)])),_:1},8,["sorted"]),n(_a,{scope:"col",style:{width:"25%"}},{default:b((()=>[y(u(d(o)("Link to the discussion")),1)])),_:1})]),i("tbody",null,[(t(!0),r(s,null,h(e.discussions,(e=>{var l,c,m;return t(),r("tr",null,[i("td",null,[i("p",Nr,[n(d(O),{text:e.title,"auto-resize":!0,"max-lines":1},null,8,["text"])]),f.value[e.subject.id]?(t(),r("p",Yr,[i("a",{class:"fr-link inline-flex",href:null===(l=f.value[e.subject.id])||void 0===l?void 0:l.page},[n(d(T),{height:12,class:"self-center",name:null===(c=f.value[e.subject.id])||void 0===c?void 0:c.icon},null,8,["name"]),n(d(O),{class:"overflow-wrap-anywhere",text:null===(m=f.value[e.subject.id])||void 0===m?void 0:m.title,"auto-resize":!0,"max-lines":1},null,8,["text"])],8,Wr)])):g("",!0)]),i("td",null,u(e.discussion.length),1),i("td",null,[i("div",null,[i("p",null,u(d(U)(w(e).posted_on)),1),i("p",Jr,[y(u(d(o)("by "))+" ",1),n(d(a),{class:"fr-ml-1v",user:w(e).posted_by},null,8,["user"])])])]),i("td",null,[e.closed?(t(),r(s,{key:0},[y(u(d(U)(e.closed)),1)],64)):g("",!0)]),i("td",null,[f.value[e.subject.id]?(t(),r("a",{key:0,class:"fr-link inline-flex",href:p(e.id,f.value[e.subject.id]),target:"_blank"},[n(d(O),{text:p(e.id,f.value[e.subject.id]),"auto-resize":!0,"max-lines":1},null,8,["text"])],8,Zr)):g("",!0)])])})),256))])])),_:1},8,["loading"]))}}),Qr={class:"fr-container--fluid"},Xr={key:0},Gr={class:"fr-breadcrumb__link","aria-current":"page"},es={class:"fr-h3 fr-mb-5v"},as={class:"subtitle subtitle--uppercase fr-m-0"},ls={class:"text-align-center fr-py-1w"},ts=["src"],rs={class:"fr-text--bold fr-my-3v"},ss=l({__name:"Discussions",props:{oid:{}},setup(e){const{t:a}=D(),l=e,s=m(!1),o=m(1),c=m(10),f=m(0),p=m("created"),h=m("desc"),w=_((()=>`${"asc"===h.value?"":"-"}${p.value}`)),x=m([]),{currentOrganization:C}=qa();function A(e,a){p.value=e,h.value=a}return k((async()=>{s.value=!0,x.value=[];try{const e=await async function(e,a,l,t){return(await Be.get(Te("discussions/"),{params:{org:e,sort:t,page_size:l,page:a}})).data}(l.oid,o.value,c.value,w.value);x.value=e.data,o.value=e.page,c.value=e.page_size,f.value=e.total}finally{s.value=!1}})),(e,l)=>{const m=z("router-link");return t(),r("div",Qr,[n(la,null,{default:b((()=>[i("li",null,[n(m,{class:"fr-breadcrumb__link",to:"/"},{default:b((()=>[y(u(d(a)("Administration")),1)])),_:1})]),d(C)?(t(),r("li",Xr,[n(m,{class:"fr-breadcrumb__link",to:"/"},{default:b((()=>[y(u(d(C).name),1)])),_:1})])):g("",!0),i("li",null,[i("a",Gr,u(d(a)("Discussions")),1)])])),_:1}),i("h1",es,u(d(a)("Discussions")),1),i("h2",as,u(d(a)("{n} discussions",f.value)),1),s.value||f.value>0?(t(),v(Kr,{key:0,discussions:x.value,loading:s.value,"sort-direction":h.value,sortedBy:p.value,onSort:A},null,8,["discussions","loading","sort-direction","sortedBy"])):(t(),v(F,{key:1,class:"fr-my-2w"},{default:b((()=>[i("div",ls,[i("img",{src:d("/_themes/gouvfr/assets/discussion.svg"),alt:"",loading:"lazy"},null,8,ts),i("p",rs,u(d(a)("There is no discussion yet")),1)])])),_:1})),f.value>c.value?(t(),v(d(X),{key:2,page:o.value,"page-size":c.value,"total-results":f.value,onChange:l[0]||(l[0]=e=>o.value=e)},null,8,["page","page-size","total-results"])):g("",!0)])}}}),ns={class:"fr-container--fluid"},os={key:0},is={class:"fr-breadcrumb__link","aria-current":"page"},us={class:"fr-h3 fr-mb-5v"},ds={class:"subtitle subtitle--uppercase fr-m-0"},cs=["href"],fs={class:"text-align-center fr-py-1w"},ms=["src"],ps={class:"fr-text--bold fr-my-3v"},vs=l({__name:"Harvesters",props:{oid:{}},setup(e){const{t:a}=D(),l=e,o=m(!1),c=m(1),f=m(10),p=m(0),_=m([]),w=m({}),{currentOrganization:x}=qa();function C(e){return`${H}harvester/${e.id}/`}function A(e){return e.last_job&&w.value[e.last_job.id]?w.value[e.last_job.id].items.filter((e=>e.dataservice)).length:0}function $(e){return e.last_job&&w.value[e.last_job.id]?w.value[e.last_job.id].items.filter((e=>e.dataset)).length:0}function S(e){var l;switch(null===(l=e.last_job)||void 0===l?void 0:l.status){case"pending":return{label:a("Pending"),type:"default"};case"initializing":return{label:a("Initializing"),type:"info"};case"initialized":return{label:a("Initialized"),type:"default"};case"processing":return{label:a("Processing"),type:"info"};case"done":return{label:a("Done"),type:"success"};case"done-errors":return{label:a("Done with errors"),type:"warning"};case"failed":return{label:a("Failed"),type:"error"};default:return{label:a("No job yet"),type:"default"}}}return k((async()=>{o.value=!0,_.value=[];try{const a=await async function(e,a,l){return(await Be.get(Te("harvest/sources/"),{params:{owner:e,deleted:!0,page:a,page_size:l}})).data}(l.oid,c.value,f.value);_.value=a.data,c.value=a.page,f.value=a.page_size,p.value=a.total;const t=[];for(const l of _.value){var e;null!==(e=l.last_job)&&void 0!==e&&e.id&&t.push(Be.get(`harvest/job/${l.last_job.id}/`))}const r=await Promise.allSettled(t);for(const e of r)"fulfilled"===e.status&&(w.value[e.value.data.id]=e.value.data)}finally{o.value=!1}})),(e,l)=>{const m=z("router-link");return t(),r("div",ns,[n(la,null,{default:b((()=>[i("li",null,[n(m,{class:"fr-breadcrumb__link",to:"/"},{default:b((()=>[y(u(d(a)("Administration")),1)])),_:1})]),d(x)?(t(),r("li",os,[n(m,{class:"fr-breadcrumb__link",to:"/"},{default:b((()=>[y(u(d(x).name),1)])),_:1})])):g("",!0),i("li",null,[i("a",is,u(d(a)("Harvesters")),1)])])),_:1}),i("h1",us,u(d(a)("Harvesters")),1),i("h2",ds,u(d(a)("{n} harvesters",p.value)),1),o.value||p.value?(t(),v(pa,{key:0,loading:o.value},{default:b((()=>[i("thead",null,[n(_a,{scope:"col"},{default:b((()=>[y(u(d(a)("Name")),1)])),_:1}),n(_a,{scope:"col"},{default:b((()=>[y(u(d(a)("Status")),1)])),_:1}),n(_a,{scope:"col"},{default:b((()=>[y(u(d(a)("Created at")),1)])),_:1}),n(_a,{scope:"col"},{default:b((()=>[y(u(d(a)("Last run")),1)])),_:1}),n(_a,{scope:"col"},{default:b((()=>[y(u(d(a)("Datasets")),1)])),_:1}),n(_a,{scope:"col"},{default:b((()=>[y(u(d(a)("Dataservices")),1)])),_:1})]),i("tbody",null,[(t(!0),r(s,null,h(_.value,(e=>{var l;return t(),r("tr",null,[i("td",null,[n(da,null,{default:b((()=>[i("a",{class:"fr-link fr-reset-link",href:C(e)},[n(d(O),{text:e.name,"auto-resize":!0,"max-lines":2},null,8,["text"])],8,cs)])),_:2},1024)]),i("td",null,[n(oa,{type:S(e).type},{default:b((()=>[y(u(S(e).label),1)])),_:2},1032,["type"])]),i("td",null,u(d(U)(e.created_at)),1),i("td",null,[null!==(l=e.last_job)&&void 0!==l&&l.ended?(t(),r(s,{key:0},[y(u(d(U)(e.last_job.ended)),1)],64)):(t(),r(s,{key:1},[y(u(d(a)("Not yet")),1)],64))]),i("td",null,u($(e)),1),i("td",null,u(A(e)),1)])})),256))])])),_:1},8,["loading"])):(t(),v(F,{key:1,class:"fr-my-2w"},{default:b((()=>[i("div",fs,[i("img",{src:d("/_themes/gouvfr/assets/harvester.svg"),alt:"",loading:"lazy"},null,8,ms),i("p",ps,u(d(a)("There is no harvesters yet")),1),n(ja,{type:"harvester"})])])),_:1})),p.value>f.value?(t(),v(d(X),{key:2,page:c.value,"page-size":f.value,"total-results":p.value,onChange:l[0]||(l[0]=e=>c.value=e)},null,8,["page","page-size","total-results"])):g("",!0)])}}}),bs=["href"],gs={key:0},_s=["href"],ys={class:"fr-p-1v monospaced bg-grey-100 fr-text--sm text-mention-grey rounded-xxs"},hs=l({__name:"AdminCommunityResourcesTable",props:{communityResources:{},loading:{type:Boolean},sortedBy:{},sortDirection:{}},emits:["sort"],setup(e){const a=e,{t:l}=D();function o(e){return a.sortedBy===e?a.sortDirection:null}function c(e){return`${H}dataset/${e.dataset.id}/community-resource/${e.id}/`}function f(e){const a=e.extras&&"check:available"in e.extras;return a&&!1===e.extras["check:available"]?{label:l("Unavailable"),type:"error"}:a?{label:l("Available"),type:"info"}:{label:l("Not checked yet"),type:"default"}}return(e,a)=>{const m=z("Vicon");return t(),v(pa,{loading:e.loading},{default:b((()=>[i("thead",null,[n(_a,{onSort:a[0]||(a[0]=a=>e.$emit("sort","title",a)),sorted:o("title"),scope:"col"},{default:b((()=>[y(u(d(l)("Resource title")),1)])),_:1},8,["sorted"]),n(_a,null,{default:b((()=>[y(u(d(l)("Status")),1)])),_:1}),n(_a,null,{default:b((()=>[y(u(d(l)("Format")),1)])),_:1}),n(_a,{onSort:a[1]||(a[1]=a=>e.$emit("sort","created_at_internal",a)),sorted:o("created_at_internal"),scope:"col"},{default:b((()=>[y(u(d(l)("Created at")),1)])),_:1},8,["sorted"]),n(_a,{onSort:a[2]||(a[2]=a=>e.$emit("sort","last_modified_internal",a)),sorted:o("last_modified_internal"),scope:"col"},{default:b((()=>[y(u(d(l)("Modified at")),1)])),_:1},8,["sorted"])]),i("tbody",null,[(t(!0),r(s,null,h(e.communityResources,(a=>{var l,s;return t(),r("tr",null,[i("td",null,[n(da,{class:"fr-text--bold"},{default:b((()=>[i("a",{class:"fr-link fr-reset-link",href:c(a)},[n(d(O),{text:a.title,"auto-resize":!0,"max-lines":2},null,8,["text"])],8,bs)])),_:2},1024),e.datasets[a.dataset.id]?(t(),r("p",gs,[i("a",{class:"fr-link inline-flex",href:null===(l=e.datasets[a.dataset.id])||void 0===l?void 0:l.page},[n(m,{height:12,class:"self-center",name:e.getSubjectTypeIcon("Dataset")},null,8,["name"]),n(d(O),{class:"overflow-wrap-anywhere",text:null===(s=e.datasets[a.dataset.id])||void 0===s?void 0:s.title,"auto-resize":!0,"max-lines":1},null,8,["text"])],8,_s)])):g("",!0)]),i("td",null,[n(oa,{type:f(a).type},{default:b((()=>[y(u(f(a).label),1)])),_:2},1032,["type"])]),i("td",null,[i("code",ys,u(a.format),1)]),i("td",null,u(d(U)(a.created_at)),1),i("td",null,u(d(U)(a.last_modified)),1)])})),256))])])),_:1},8,["loading"])}}}),ws={class:"fr-container--fluid"},ks={key:0},zs={class:"fr-breadcrumb__link","aria-current":"page"},xs={class:"fr-h3 fr-mb-5v"},Cs={class:"subtitle subtitle--uppercase fr-m-0"},As={class:"text-align-center fr-py-1w"},$s=["src"],Ss={class:"fr-text--bold fr-my-3v"},Ds=l({__name:"CommunityResources",props:{oid:{}},setup(e){const{t:a}=D(),l=e,s=m([]),o=m(!1),c=m(1),f=m(10),p=m(0),h=m("created_at_internal"),w=m("desc"),x=_((()=>`${"asc"===w.value?"":"-"}${h.value}`)),{currentOrganization:C}=qa(),A=W();function $(e,a){h.value=e,w.value=a}return k((async()=>{o.value=!0,s.value=[];try{let e;if(l.oid)e=await Ve(l.oid,c.value,f.value,x.value);else{if(!A.value)return;e=await Ie(A.value.id,c.value,f.value,x.value)}s.value=e.data,c.value=e.page,f.value=e.page_size,p.value=e.total}finally{o.value=!1}})),(e,l)=>{const m=z("router-link");return t(),r("div",ws,[n(la,null,{default:b((()=>[i("li",null,[n(m,{class:"fr-breadcrumb__link",to:"/"},{default:b((()=>[y(u(d(a)("Administration")),1)])),_:1})]),d(C)?(t(),r("li",ks,[n(m,{class:"fr-breadcrumb__link",to:"/"},{default:b((()=>[y(u(d(C).name),1)])),_:1})])):g("",!0),i("li",null,[i("a",zs,u(d(a)("Community Resources")),1)])])),_:1}),i("h1",xs,u(d(a)("Community Resources")),1),i("h2",Cs,u(d(a)("{n} community resources",s.value.length)),1),o.value||p.value>0?(t(),v(hs,{key:0,"community-resources":s.value,loading:o.value,sortDirection:w.value,sortedBy:h.value,onSort:$},null,8,["community-resources","loading","sortDirection","sortedBy"])):(t(),v(F,{key:1,class:"fr-mt-1w fr-mb-2w"},{default:b((()=>[i("div",As,[i("img",{src:d(He),alt:"",loading:"lazy"},null,8,$s),i("p",Ss,u(d(a)("You haven't published a community resource yet")),1)])])),_:1})),p.value>f.value?(t(),v(d(X),{key:2,page:c.value,"page-size":f.value,"total-results":p.value,onChange:l[0]||(l[0]=e=>c.value=e)},null,8,["page","page-size","total-results"])):g("",!0)])}}});Ee({admin_root:H,default_lang:Le.global.locale.value,only_locales:Le.global.locale.value,schema_documentation_url:Ne,schema_validata_url:Ye,show_copy_resource_permalink:!0,tabular_api_url:We,tabular_page_size:Je,title:N});const qs=[{path:"/me",children:[{path:"",component:fl,name:"me"},{path:"datasets",component:Na,name:"me-datasets"},{path:"reuses",component:nl,name:"me-reuses"},{path:"community-resources",component:Ds,name:"me-community-resources"}]},{path:"/organizations/:oid",children:[{path:"datasets",component:Na,props:!0,name:"organization-datasets"},{path:"reuses",component:nl,props:!0,name:"organization-reuses"},{path:"discussions",component:ss,props:!0,name:"organization-discussions"},{path:"members",component:ir,props:!0,name:"organization-members"},{path:"harvesters",component:vs,props:!0,name:"organization-harvesters"},{path:"community-resources",component:Ds,props:!0,name:"organization-community-resources"},{path:"profile",component:Ur,props:!0,name:"organization-profile"}]}],Bs=Ze({history:Ke(),routes:qs}),Ps=$(Ml);Qe(Ps),Ps.use(Xe),Ps.use(Ge),Ps.use(Le),Ps.use(Bs),Ps.mount("#admin"),globalThis.dsfr.start(),console.log("JS is injected !")}}}));
