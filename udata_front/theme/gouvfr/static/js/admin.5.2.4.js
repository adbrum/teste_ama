import{defineComponent as T,openBlock as c,createElementBlock as h,Fragment as B,createVNode as n,mergeProps as _e,createElementVNode as t,toDisplayString as o,unref as e,renderSlot as H,normalizeClass as X,ref as z,onMounted as re,createBlock as S,withCtx as u,createCommentVNode as R,computed as F,createTextVNode as $,renderList as N,readonly as Pe,watchEffect as Z,resolveComponent as P,watchPostEffect as Oe,Teleport as ie,withModifiers as le,createApp as Ie}from"vue";import{B as de,u as M,x as V,bw as Fe,F as x,_ as G,b as pe,bx as Le,e as be,aj as W,y as E,J as j,z as je,D as U,be as ee,by as Ue,bz as He,at as ve,bi as Ve,bA as ue,bB as Ee,bC as Ne,bD as xe,ao as We,K as oe,ab as Ye,bE as Je,bF as Ze,b9 as Ke,bG as Qe,bH as Ce,aV as Xe,V as Q,a5 as Ge,aS as Se,bI as et,au as tt,X as ce,$ as st,bJ as ot,bK as at,aI as nt,bL as lt,bM as rt,bN as he,bO as it,bP as dt,bQ as ut,bR as De,bS as ct,bT as ft,v as mt,A as _t,bd as pt,bU as bt,bV as vt,bg as gt,a as ae,bW as ht,bX as yt,bY as $t,bZ as wt,a6 as Re,b_ as kt,b$ as zt,c0 as Te,c1 as At,c2 as Ct,aq as St,bk as Dt,bn as me,aU as Rt,bo as Tt,bq as qt,br as Mt,c3 as Bt,c4 as Pt,bs as Ot,bt as It,bu as Ft}from"./sentry.5.2.4.js";import"vue-content-loader";import"./_commonjsHelpers.5.2.4.js";function ml(){import.meta.url,import("_").catch(()=>1);async function*m(){}}const Lt={class:"fr-ml-1v fr-text--bold"},jt=T({__name:"AvatarWithName",props:{user:{},size:{default:12}},setup(m){return(s,a)=>(c(),h(B,null,[n(de,_e(s.$attrs,{user:s.user,size:s.size,rounded:!0}),null,16,["user","size"]),t("span",Lt,o(s.user.first_name)+" "+o(s.user.last_name),1)],64))}}),Ut=["aria-label"],Ht={class:"fr-breadcrumb__list"},Y={__name:"Breadcrumb",setup(m){const{t:s}=M();return(a,b)=>(c(),h("nav",{rol:"navigation","aria-label":e(s)("You're here:"),class:"fr-breadcrumb fr-mb-5v"},[t("ol",Ht,[H(a.$slots,"default")])],8,Ut))}},Vt={class:"fr-text--sm fr-my-0"},Et={class:"fr-grid-row fr-grid-row--right not-enlarged"},Nt=["href","title"],xt=T({__name:"QualityScoreTooltipContent",props:{dataset:{}},setup(m){const{t:s}=M();return(a,b)=>(c(),h(B,null,[t("h5",Vt,o(e(s)("Metadata quality:")),1),n(e(V),{passed:a.dataset.quality.dataset_description_quality,messagePassed:e(s)("Data description filled"),messageFailed:e(s)("Data description empty"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),n(e(V),{passed:a.dataset.quality.resources_documentation,messagePassed:e(s)("Files documented"),messageFailed:e(s)("Files documentation missing"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),n(e(V),{passed:a.dataset.quality.license,messagePassed:e(s)("License filled"),messageFailed:e(s)("No license set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),n(e(V),{passed:a.dataset.quality.update_frequency&&!!a.dataset.quality.update_fulfilled_in_time,messagePassed:e(s)("Update frequency followed"),messageFailed:a.dataset.quality.update_frequency?e(s)("Update frequency not followed"):e(s)("Update frequency not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),n(e(V),{passed:a.dataset.quality.has_open_format,messagePassed:e(s)("File formats are open"),messageFailed:e(s)("File formats are closed"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),n(e(V),{passed:a.dataset.quality.temporal_coverage,messagePassed:e(s)("Temporal coverage filled"),messageFailed:e(s)("Temporal coverage not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),n(e(V),{passed:a.dataset.quality.spatial,messagePassed:e(s)("Spatial coverage filled"),messageFailed:e(s)("Spatial coverage not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),n(e(V),{passed:a.dataset.quality.all_resources_available,messagePassed:e(s)("All files are available"),messageFailed:e(s)("Some files are unavailable"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),t("div",Et,[t("a",{href:e(Fe),target:"_blank",rel:"noopener",title:e(s)("Learn more about this indicator - opens a new window")},o(e(s)("Learn more about this indicator")),9,Nt)])],64))}}),ne=T({__name:"AdminBadge",props:{type:{}},setup(m){return(s,a)=>(c(),h("p",{class:X(["fr-badge",{"fr-badge--blue-cumulus":s.type==="info","fr-badge--error fr-badge--no-icon":s.type==="error","fr-badge--warning fr-badge--no-icon":s.type==="warning","fr-badge--success fr-badge--no-icon":s.type==="success"}])},[H(s.$slots,"default")],2))}}),Wt=["aria-describedby"],Yt=["id"],Jt=T({inheritAttrs:!1,__name:"AdminContentWithTooltip",setup(m){const s=x(),a=z(),b=z("");return re(()=>{a.value&&(b.value=a.value.textContent||"")}),(r,i)=>(c(),h(B,null,[t("p",_e(r.$attrs,{"aria-describedby":e(s),ref_key:"contentRef",ref:a}),[H(r.$slots,"default",{},void 0,!0)],16,Wt),t("span",{class:"fr-hidden-xl fr-tooltip fr-placement",id:e(s),role:"tooltip","aria-hidden":"true"},o(b.value),9,Yt)],64))}});const fe=G(Jt,[["__scopeId","data-v-d192f17a"]]),qe=T({__name:"AdminLoader",props:{scale:{default:4}},setup(m){return pe(Le),(s,a)=>(c(),S(e(be),{name:"ri-loader-5-line",animation:"spin",scale:s.scale,fill:"var(--blue-cumulus-sun-368-moon-732)"},null,8,["scale"]))}}),Zt={class:"fr-table fr-mb-2w"},Kt=T({__name:"AdminTable",props:{loading:{type:Boolean,default:!1}},setup(m){return(s,a)=>(c(),h("div",Zt,[t("table",null,[H(s.$slots,"default",{},void 0,!0)]),s.loading?(c(),S(W,{key:0,class:"fr-p-4w text-align-center"},{default:u(()=>[n(qe)]),_:1})):R("",!0)]))}});const te=G(Kt,[["__scopeId","data-v-cae574a4"]]),Qt={class:"fr-text--bold"},Xt={key:1,class:"fr-grid-row fr-grid-row--middle justify-between"},Gt=["title"],es=T({__name:"AdminTableTh",props:{sorted:{}},emits:["sort"],setup(m,{emit:s}){const a=m,b=s,{t:r}=M(),i=F(()=>a.sorted!==void 0);function l(){return a.sorted==="desc"?b("sort","asc"):b("sort","desc")}return(d,p)=>(c(),h("th",Qt,[i.value?(c(),h("div",Xt,[H(d.$slots,"default",{},void 0,!0),t("button",{class:X(["fr-ml-1w fr-btn fr-btn--sm fr-btn--tertiary-no-outline",{"fr-icon-arrow-down-line":!d.sorted||d.sorted==="asc","fr-icon-arrow-up-line":d.sorted==="desc","text-grey-500":d.sorted,"text-mention-grey":!d.sorted}]),onClick:l,title:e(r)("Sort")},o(e(r)("Sort")),11,Gt)])):H(d.$slots,"default",{key:0},void 0,!0)]))}});const D=G(es,[["__scopeId","data-v-5acf0bf0"]]),ts=["aria-describedby"],ss=["id"],L=T({__name:"Tooltip",setup(m){const s=x("tooltip");return(a,b)=>(c(),h(B,null,[t("p",_e(a.$attrs,{"aria-describedby":e(s)}),[H(a.$slots,"default")],16,ts),t("span",{class:"fr-tooltip fr-placement",id:e(s),role:"tooltip","aria-hidden":"true"},[H(a.$slots,"tooltip")],8,ss)],64))}}),os=["href"],as={class:"monospace"},ns={class:"monospace"},ls={class:"monospace"},rs={class:"monospace"},is={class:"monospace"},ds=T({__name:"AdminDatasetsTable",props:{datasets:{},loading:{type:Boolean},sortDirection:{},sortedBy:{}},emits:["sort"],setup(m,{emit:s}){const a=s,b=m,{t:r}=M();function i(_,v){a("sort",_,v)}function l(_){return b.sortedBy===_?b.sortDirection:null}function d(_){return Array.isArray(_.resources)?_.resources.length:_.resources.total}function p(_){return"".concat(ee,"dataset/").concat(_.id,"/")}function g(_){return _.deleted?{label:r("Deleted"),type:"error"}:_.archived?{label:r("Archived"),type:"warning"}:_.private?{label:r("Private"),type:"default"}:{label:r("Public"),type:"info"}}return(_,v)=>(c(),S(te,{loading:_.loading},{default:u(()=>[t("thead",null,[t("tr",null,[n(D,{onSort:v[0]||(v[0]=f=>i("title",f)),sorted:l("title"),scope:"col"},{default:u(()=>[$(o(e(r)("Title of the dataset")),1)]),_:1},8,["sorted"]),n(D,{scope:"col"},{default:u(()=>[$(o(e(r)("Status")),1)]),_:1}),n(D,{onSort:v[1]||(v[1]=f=>i("created",f)),sorted:l("created"),scope:"col"},{default:u(()=>[$(o(e(r)("Created at")),1)]),_:1},8,["sorted"]),n(D,{onSort:v[2]||(v[2]=f=>i("last_update",f)),sorted:l("last_update"),scope:"col"},{default:u(()=>[$(o(e(r)("Updated at")),1)]),_:1},8,["sorted"]),n(D,{scope:"col"},{default:u(()=>[$(o(e(r)("Files")),1)]),_:1}),n(D,{scope:"col"},{default:u(()=>[$(o(e(r)("Score")),1)]),_:1}),n(D,{scope:"col"},{default:u(()=>[n(L,null,{tooltip:u(()=>[$(o(e(r)("Discussions")),1)]),default:u(()=>[v[6]||(v[6]=t("span",{class:"fr-icon--sm fr-icon-chat-3-line","aria-hidden":"true"},null,-1))]),_:1})]),_:1}),n(D,{onSort:v[3]||(v[3]=f=>i("views",f)),sorted:l("views"),scope:"col"},{default:u(()=>[n(L,null,{tooltip:u(()=>[$(o(e(r)("Views")),1)]),default:u(()=>[v[7]||(v[7]=t("span",{class:"fr-icon--sm fr-icon-eye-line","aria-hidden":"true"},null,-1))]),_:1})]),_:1},8,["sorted"]),n(D,{scope:"col"},{default:u(()=>[n(L,null,{tooltip:u(()=>[$(o(e(r)("Downloads")),1)]),default:u(()=>[v[8]||(v[8]=t("span",{class:"fr-icon--sm fr-icon-download-line","aria-hidden":"true"},null,-1))]),_:1})]),_:1}),n(D,{onSort:v[4]||(v[4]=f=>i("reuses",f)),sorted:l("reuses"),scope:"col"},{default:u(()=>[n(L,null,{tooltip:u(()=>[$(o(e(r)("Reuses")),1)]),default:u(()=>[v[9]||(v[9]=t("span",{class:"fr-icon--sm fr-icon-line-chart-line","aria-hidden":"true"},null,-1))]),_:1})]),_:1},8,["sorted"]),n(D,{onSort:v[5]||(v[5]=f=>i("followers",f)),sorted:l("followers"),scope:"col"},{default:u(()=>[n(L,null,{tooltip:u(()=>[$(o(e(r)("Favorites")),1)]),default:u(()=>[v[10]||(v[10]=t("span",{class:"fr-icon--sm fr-icon-star-s-line","aria-hidden":"true"},null,-1))]),_:1})]),_:1},8,["sorted"])])]),t("tbody",null,[(c(!0),h(B,null,N(_.datasets,f=>{var w;return c(),h("tr",{key:f.id},[t("td",null,[n(fe,null,{default:u(()=>[t("a",{class:"fr-link fr-reset-link",href:p(f)},[n(e(E),{text:f.title,"auto-resize":!0,"max-lines":2},null,8,["text"])],8,os)]),_:2},1024)]),t("td",null,[n(ne,{type:g(f).type},{default:u(()=>[$(o(g(f).label),1)]),_:2},1032,["type"])]),t("td",null,o(e(j)(f.created_at)),1),t("td",null,o(e(j)(f.last_modified)),1),t("td",null,o(d(f)),1),t("td",null,[n(L,null,{tooltip:u(()=>[n(xt,{dataset:f},null,8,["dataset"])]),default:u(()=>[n(e(je),{class:"w-100",score:f.quality.score},null,8,["score"])]),_:2},1024)]),t("td",as,o(e(U)(f.metrics.discussions)),1),t("td",ns,o(e(U)(f.metrics.views)),1),t("td",ls,o(e(U)((w=f.metrics.resources_downloads)!=null?w:0)),1),t("td",rs,o(e(U)(f.metrics.reuses)),1),t("td",is,o(e(U)(f.metrics.followers)),1)])}),128))])]),_:1},8,["loading"]))}}),ye=z(null);function J(){const m=s=>{ye.value=s};return{currentOrganization:Pe(ye),setCurrentOrganization:m}}const us="/_themes/gouvfr/assets/logotype-white.svg",cs=["href"],fs=["src","alt"],ge=T({__name:"AdminPublishButton",props:{type:{}},setup(m){const s=m,{t:a}=M(),b=F(()=>{switch(s.type){case"dataset":return He;case"harvester":return"".concat(ee,"harvester/new/");case"reuse":return Ue}});return(r,i)=>(c(),h("a",{href:b.value,class:"fr-btn fr-icon-add-line fr-btn--icon-left"},[$(o(e(a)("Publish on"))+" ",1),t("img",{class:"fr-ml-1v",src:e(us),loading:"lazy",alt:e(ve)},null,8,fs)],8,cs))}}),ms={key:0},_s={class:"fr-breadcrumb__link","aria-current":"page"},ps={class:"fr-h3 fr-mb-5v"},bs={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle"},vs={class:"fr-col"},gs={class:"subtitle subtitle--uppercase fr-m-0"},hs={key:0,class:"fr-col-auto fr-grid-row fr-grid-row--middle"},ys=["href"],$s={class:"text-align-center fr-py-1w"},ws=["src"],ks={class:"fr-text--bold fr-my-3v"},$e=T({__name:"Datasets",props:{oid:{}},setup(m){const{t:s}=M(),a=m,b=z([]),r=z(!1),i=z(1),l=z(10),d=z(0),p=z("created"),g=z("desc"),_=F(()=>"".concat(g.value==="asc"?"":"-").concat(p.value)),v=z(""),f=Ve(v,Ye),{currentOrganization:w}=J(),y=ue();function A(k,C){p.value=k,g.value=C}return Z(async()=>{r.value=!0,b.value=[];try{let k;if(a.oid)k=await Ee(a.oid,f.value,i.value,l.value,_.value);else if(y.value)k=await Ne(y.value.id,f.value,i.value,l.value,_.value);else return;b.value=k.data,i.value=k.page,l.value=k.page_size,d.value=k.total}finally{r.value=!1}}),(k,C)=>{const q=P("router-link");return c(),h("div",null,[n(Y,null,{default:u(()=>[t("li",null,[n(q,{class:"fr-breadcrumb__link",to:"/"},{default:u(()=>[$(o(e(s)("Administration")),1)]),_:1})]),e(w)?(c(),h("li",ms,[n(q,{class:"fr-breadcrumb__link",to:"/"},{default:u(()=>[$(o(e(w).name),1)]),_:1})])):R("",!0),t("li",null,[t("a",_s,o(e(s)("Datasets")),1)])]),_:1}),t("h1",ps,o(e(s)("Datasets")),1),t("div",bs,[t("div",vs,[t("h2",gs,o(e(s)("{n} datasets",d.value)),1)]),k.oid?(c(),h("div",hs,[t("div",null,[t("a",{href:e(xe)(k.oid,d.value),class:"fr-btn fr-btn--sm fr-icon-download-line fr-btn--icon-left"},o(e(s)("Download catalog")),9,ys)])])):R("",!0)]),r.value||d.value>0?(c(),S(ds,{key:0,datasets:b.value,loading:r.value,"sort-direction":g.value,sortedBy:p.value,onSort:A},null,8,["datasets","loading","sort-direction","sortedBy"])):(c(),S(W,{key:1,class:"fr-my-2w"},{default:u(()=>[t("div",$s,[t("img",{src:e(We),alt:"",loading:"lazy"},null,8,ws),t("p",ks,o(e(s)("You haven't published a dataset yet")),1),n(ge,{type:"dataset"})])]),_:1})),d.value>l.value?(c(),S(e(oe),{key:2,page:i.value,"page-size":l.value,"total-results":d.value,onChange:C[0]||(C[0]=K=>i.value=K)},null,8,["page","page-size","total-results"])):R("",!0)])}}}),zs=["href"],As={class:"monospace"},Cs={class:"monospace"},Ss={class:"monospace"},Ds={class:"monospace"},Rs=T({__name:"AdminReusesTable",props:{reuses:{},loading:{type:Boolean},sortedBy:{},sortDirection:{}},emits:["sort"],setup(m){const s=m,{t:a}=M();function b(l){return s.sortedBy===l?s.sortDirection:null}function r(l){return"".concat(ee,"reuse/").concat(l.id,"/")}function i(l){return l.deleted?{label:a("Deleted"),type:"error"}:l.archived?{label:a("Archived"),type:"warning"}:l.private?{label:a("Private"),type:"default"}:{label:a("Public"),type:"info"}}return(l,d)=>(c(),S(te,{loading:l.loading},{default:u(()=>[t("thead",null,[n(D,{onSort:d[0]||(d[0]=p=>l.$emit("sort","title",p)),sorted:b("title"),scope:"col"},{default:u(()=>[$(o(e(a)("Reuse title")),1)]),_:1},8,["sorted"]),n(D,null,{default:u(()=>[$(o(e(a)("Status")),1)]),_:1}),n(D,{onSort:d[1]||(d[1]=p=>l.$emit("sort","created",p)),sorted:b("created"),scope:"col"},{default:u(()=>[$(o(e(a)("Created at")),1)]),_:1},8,["sorted"]),n(D,{onSort:d[2]||(d[2]=p=>l.$emit("sort","datasets",p)),sorted:b("datasets"),scope:"col"},{default:u(()=>[$(o(e(a)("Datasets")),1)]),_:1},8,["sorted"]),n(D,{scope:"col"},{default:u(()=>[n(L,null,{tooltip:u(()=>[$(o(e(a)("Discussions")),1)]),default:u(()=>[d[5]||(d[5]=t("span",{class:"fr-icon--sm fr-icon-chat-3-line","aria-hidden":"true"},null,-1))]),_:1})]),_:1}),n(D,{onSort:d[3]||(d[3]=p=>l.$emit("sort","views",p)),sorted:b("views"),scope:"col"},{default:u(()=>[n(L,null,{tooltip:u(()=>[$(o(e(a)("Views")),1)]),default:u(()=>[d[6]||(d[6]=t("span",{class:"fr-icon--sm fr-icon-eye-line","aria-hidden":"true"},null,-1))]),_:1})]),_:1},8,["sorted"]),n(D,{onSort:d[4]||(d[4]=p=>l.$emit("sort","followers",p)),sorted:b("followers"),scope:"col"},{default:u(()=>[n(L,null,{tooltip:u(()=>[$(o(e(a)("Favorites")),1)]),default:u(()=>[d[7]||(d[7]=t("span",{class:"fr-icon--sm fr-icon-star-s-line","aria-hidden":"true"},null,-1))]),_:1})]),_:1},8,["sorted"])]),t("tbody",null,[(c(!0),h(B,null,N(l.reuses,p=>(c(),h("tr",null,[t("td",null,[n(fe,null,{default:u(()=>[t("a",{class:"fr-link fr-reset-link",href:r(p)},[n(e(E),{text:p.title,"auto-resize":!0,"max-lines":2},null,8,["text"])],8,zs)]),_:2},1024)]),t("td",null,[n(ne,{type:i(p).type},{default:u(()=>[$(o(i(p).label),1)]),_:2},1032,["type"])]),t("td",null,o(e(j)(p.created_at)),1),t("td",As,o(e(U)(p.datasets.length)),1),t("td",Cs,o(e(U)(p.metrics.discussions)),1),t("td",Ss,o(e(U)(p.metrics.views)),1),t("td",Ds,o(e(U)(p.metrics.followers)),1)]))),256))])]),_:1},8,["loading"]))}}),Ts="/_themes/gouvfr/assets/reuse.svg",qs={class:"fr-container--fluid"},Ms={key:0},Bs={class:"fr-breadcrumb__link","aria-current":"page"},Ps={class:"fr-h3 fr-mb-5v"},Os={class:"subtitle subtitle--uppercase fr-mb-0"},Is={class:"text-align-center fr-py-1w"},Fs=["src"],Ls={class:"fr-text--bold fr-my-3v"},we=T({__name:"Reuses",props:{oid:{}},setup(m){const{t:s}=M(),a=m,b=z([]),r=z(!1),i=z(1),l=z(10),d=z(0),p=z("created"),g=z("desc"),_=F(()=>"".concat(g.value==="asc"?"":"-").concat(p.value)),{currentOrganization:v}=J(),f=ue();function w(y,A){p.value=y,g.value=A}return Z(async()=>{r.value=!0,b.value=[];try{let y;if(a.oid)y=await Je(a.oid,i.value,l.value,_.value);else if(f.value)y=await Ze(f.value.id,i.value,l.value,_.value);else return;b.value=y.data,i.value=y.page,l.value=y.page_size,d.value=y.total}finally{r.value=!1}}),(y,A)=>{const k=P("router-link");return c(),h("div",qs,[n(Y,null,{default:u(()=>[t("li",null,[n(k,{class:"fr-breadcrumb__link",to:"/"},{default:u(()=>[$(o(e(s)("Administration")),1)]),_:1})]),e(v)?(c(),h("li",Ms,[n(k,{class:"fr-breadcrumb__link",to:"/"},{default:u(()=>[$(o(e(v).name),1)]),_:1})])):R("",!0),t("li",null,[t("a",Bs,o(e(s)("Reuses")),1)])]),_:1}),t("h1",Ps,o(e(s)("Reuses")),1),t("h2",Os,o(e(s)("{n} reuses of your organization",b.value.length)),1),r.value||d.value>0?(c(),S(Rs,{key:0,reuses:b.value,loading:r.value,sortDirection:g.value,sortedBy:p.value,onSort:w},null,8,["reuses","loading","sortDirection","sortedBy"])):(c(),S(W,{key:1,class:"fr-mt-1w fr-mb-2w"},{default:u(()=>[t("div",Is,[t("img",{src:e(Ts),alt:"",loading:"lazy"},null,8,Fs),t("p",Ls,o(e(s)("You haven't published a reuse yet")),1),n(ge,{type:"reuse"})])]),_:1})),d.value>l.value?(c(),S(e(oe),{key:2,page:i.value,"page-size":l.value,"total-results":d.value,onChange:A[0]||(A[0]=C=>i.value=C)},null,8,["page","page-size","total-results"])):R("",!0)])}}}),js={class:"fr-breadcrumb__link","aria-current":"page"},Us={key:0,class:"fr-h1"},Hs={class:"fr-alert fr-alert--info"},Vs={class:"fr-alert__title"},Es={href:"/admin/me/"},Ns=T({__name:"Me",setup(m){const{t:s}=M(),a=ue();return(b,r)=>{const i=P("router-link");return c(),h("div",null,[n(Y,null,{default:u(()=>[t("li",null,[n(i,{class:"fr-breadcrumb__link",to:"/"},{default:u(()=>[$(o(e(s)("Administration")),1)]),_:1})]),t("li",null,[t("a",js,o(e(s)("Me")),1)])]),_:1}),e(a)?(c(),h("h1",Us,o(e(a).first_name)+" "+o(e(a).last_name),1)):R("",!0),t("div",Hs,[t("h3",Vs,o(e(s)("This is a WIP page")),1),t("p",null,[t("a",Es,o(e(s)("You can edit your profil on the current admin.")),1)])])])}}}),ke='<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M5 12V18C5 18 5 21 12 21C19 21 19 18 19 18V12" stroke="currentColor" stroke-width="1.5"/>\n<path d="M5 6V12C5 12 5 15 12 15C19 15 19 12 19 12V6" stroke="currentColor" stroke-width="1.5"/>\n<path d="M12 3C19 3 19 6 19 6C19 6 19 9 12 9C5 9 5 6 5 6C5 6 5 3 12 3Z" stroke="currentColor" stroke-width="1.5"/>\n</svg>\n',xs={class:"fr-sidemenu__item"},Ws=["innerHTML"],Ys=T({__name:"AdminSidebarLink",props:{label:{},icon:{},iconHtml:{},to:{}},setup(m){return(s,a)=>{const b=P("TextClamp"),r=P("router-link");return c(),h("li",xs,[t("div",{class:X([{"fr-icon-svg fr-icon--sm":s.iconHtml},"fr-enlarge-link fr-sidemenu__link fr-mb-1w"])},[s.iconHtml?(c(),h("div",{key:0,class:"fr-mr-1w fr-grid-row",innerHTML:s.iconHtml},null,8,Ws)):s.icon?(c(),h("div",{key:1,class:X([s.icon,"fr-mr-1w fr-icon--sm"]),"aria-hidden":"true"},null,2)):R("",!0),n(r,{to:s.to},{default:u(()=>[n(b,{text:s.label,"auto-resize":!0,"max-lines":1},null,8,["text"])]),_:1},8,["to"])],2)])}}});const I=G(Ys,[["__scopeId","data-v-65a3b831"]]),Js=["aria-expanded","aria-controls","aria-current"],Zs={class:"fr-mx-1w"},Ks={class:"logo logo--sm"},Qs={class:"fr-mx-1w fr-col text-overflow-ellipsis"},Xs=["id"],Gs={class:"fr-sidemenu__list fr-mx-1w fr-my-3v"},eo=T({__name:"AdminSidebarMenu",props:{user:{},organization:{},isOpened:{type:Boolean}},emits:["open","click"],setup(m){const s=m,{t:a}=M(),b=x("menu");function r(i,l){const d=document.getElementById(b);l(d)&&(i?l(d).collapse.disclose():l(d).collapse.conceal())}return Oe(()=>{setTimeout(()=>{r(s.isOpened,globalThis.dsfr)},200)}),(i,l)=>(c(),h("li",{class:X(["fr-sidemenu__item",{"fr-sidemenu__item--active":i.isOpened}])},[t("button",{class:"fr-sidemenu__btn","aria-expanded":i.isOpened,"aria-controls":e(b),"aria-current":i.isOpened,onClick:l[0]||(l[0]=d=>i.$emit("open"))},[i.user?(c(),h(B,{key:0},[i.user?(c(),S(e(de),{key:0,user:i.user,size:24,rounded:!0},null,8,["user"])):R("",!0),t("p",Zs,o(e(a)("My Profil")),1)],64)):i.organization?(c(),h(B,{key:1},[t("div",Ks,[n(Ke,{type:"organization",src:i.organization.logo_thumbnail,size:20},null,8,["src"])]),t("p",Qs,o(i.organization.name),1)],64)):R("",!0)],8,Js),t("div",{class:"fr-collapse","data-fr-js-collapse":"",id:e(b)},[t("ul",Gs,[i.user?(c(),h(B,{key:0},[n(I,{icon:"fr-icon-account-circle-line",label:e(a)("Me"),to:{name:"me"}},null,8,["label"]),n(I,{iconHtml:e(ke),label:e(a)("Datasets"),to:{name:"me-datasets"}},null,8,["iconHtml","label"]),n(I,{icon:"fr-icon-line-chart-line",label:e(a)("Reuses"),to:{name:"me-reuses"}},null,8,["label"]),n(I,{icon:"fr-icon-git-pull-request-line",label:e(a)("Community Resources"),to:{name:"me-community-resources"}},null,8,["label"])],64)):i.organization?(c(),h(B,{key:1},[n(I,{iconHtml:e(ke),label:e(a)("Datasets"),to:{name:"organization-datasets",params:{oid:i.organization.id}},onClick:l[1]||(l[1]=d=>i.$emit("click"))},null,8,["iconHtml","label","to"]),n(I,{icon:"fr-icon-line-chart-line",label:e(a)("Reuses"),to:{name:"organization-reuses",params:{oid:i.organization.id}},onClick:l[2]||(l[2]=d=>i.$emit("click"))},null,8,["label","to"]),n(I,{icon:"fr-icon-chat-3-line",label:e(a)("Discussions"),to:{name:"organization-discussions",params:{oid:i.organization.id}},onClick:l[3]||(l[3]=d=>i.$emit("click"))},null,8,["label","to"]),n(I,{icon:"fr-icon-parent-line",label:e(a)("Members"),to:{name:"organization-members",params:{oid:i.organization.id}},onClick:l[4]||(l[4]=d=>i.$emit("click"))},null,8,["label","to"]),n(I,{icon:"fr-icon-server-line",label:e(a)("Harvesters"),to:{name:"organization-harvesters",params:{oid:i.organization.id}},onClick:l[5]||(l[5]=d=>i.$emit("click"))},null,8,["label","to"]),n(I,{icon:"fr-icon-git-pull-request-line",label:e(a)("Community Resources"),to:{name:"organization-community-resources",params:{oid:i.organization.id}},onClick:l[6]||(l[6]=d=>i.$emit("click"))},null,8,["label","to"]),n(I,{icon:"fr-icon-user-line",label:e(a)("Profile"),to:{name:"organization-profile",params:{oid:i.organization.id}},onClick:l[7]||(l[7]=d=>i.$emit("click"))},null,8,["label","to"])],64)):R("",!0)])],8,Xs)],2))}});const ze=G(eo,[["__scopeId","data-v-c097b9c2"]]),to={class:"fr-container--fluid h-100"},so={class:"fr-grid-row h-100 bg-grey-50"},oo={class:"fr-col-12 fr-col-md-4 fr-col-lg-3 fr-col-xl-2"},ao=["aria-label"],no={class:"fr-sidemenu__inner"},lo=["aria-controls"],ro=["id"],io={class:"fr-sidemenu__list"},uo={class:"fr-col-12 fr-col-md-8 fr-col-lg-9 fr-col-xl-10 h-100 fr-px-2w overflow-auto"},co=T({__name:"Admin",setup(m){const{t:s}=M(),a=Qe(),b=x("menu"),r=z(null),i=z(),{setCurrentOrganization:l}=J(),d=Ce();function p(_){return _===i.value}function g(_){i.value=_.id}return re(async()=>{var _,v;if(r.value=await Xe(),a.name||(r.value.organizations.length>0?d.replace({name:"organization-datasets",params:{oid:r.value.organizations[0].id}}):d.replace({name:"me"})),a.name==="me")i.value=(_=Q)==null?void 0:_.id;else if(r.value.organizations.length>0){let f=r.value.organizations[0];a.params.oid&&(f=(v=r.value.organizations.find(w=>w.id===a.params.oid))!=null?v:f),g(f),l(f)}}),(_,v)=>{const f=P("router-view");return c(),h("div",to,[t("div",so,[t("div",oo,[t("nav",{class:"fr-sidemenu fr-pr-0","aria-label":e(s)("Administration menu")},[t("div",no,[t("button",{class:"fr-sidemenu__btn",hidden:"","aria-controls":e(b),"aria-expanded":"false"},o(e(s)("Open menu")),9,lo),t("div",{class:"fr-collapse",id:e(b)},[t("ul",io,[e(Q)?(c(),S(ze,{key:0,user:e(Q),"is-opened":p(e(Q).id),onOpen:v[0]||(v[0]=w=>g(e(Q)))},null,8,["user","is-opened"])):R("",!0),r.value?(c(!0),h(B,{key:1},N(r.value.organizations,w=>(c(),S(ze,{organization:w,"is-opened":p(w.id),onOpen:()=>g(w),onClick:()=>e(l)(w)},null,8,["organization","is-opened","onOpen","onClick"]))),256)):R("",!0)])],8,ro)])],8,ao)]),t("div",uo,[(c(),S(f,{key:e(a).fullPath,class:"fr-container--fluid"}))])])])}}});const fo=G(co,[["__scopeId","data-v-364348c3"]]),mo=["aria-labelledby","id"],_o={class:"fr-container fr-container--fluid fr-container-md"},po={class:"fr-grid-row fr-grid-row--center"},bo={class:"fr-col-12 fr-col-md-8"},vo={class:"fr-modal__body"},go={class:"fr-modal__header"},ho=["title","aria-controls"],yo={class:"fr-modal__content"},$o=["id"],wo={class:"fr-modal__footer"},ko={class:"fr-btns-group fr-btns-group--right fr-btns-group--sm fr-btns-group--inline-lg fr-btns-group--icon-left"},zo=["disabled"],Ao=["disabled"],Co=T({__name:"AdminAddMemberModal",props:{id:{},oid:{},roles:{}},emits:["memberAdded"],setup(m,{emit:s}){const a=m,b=s,{t:r}=M(),{toast:i}=ce(),l=z(!1),d=z(),p=z("editor"),g=F(()=>"fr-modal-title-user-"+a.id);async function _(){try{l.value=!0,d.value&&(await et(a.oid,d.value,p.value),b("memberAdded"),f())}catch(w){i.error(r("An error occurred while update member role."))}finally{l.value=!1}}function v(w){return w.map(y=>{var k;const A={...y,avatar_thumbnail:(k=y.avatar_url)!=null?k:void 0};return{value:A.id,label:A.first_name+" "+A.last_name,image:tt(A,32)}})}function f(){l.value=!1,d.value=void 0,p.value="editor";const w=document.getElementById(a.id);globalThis.dsfr(w).modal.conceal()}return(w,y)=>(c(),S(ie,{to:"body"},[t("dialog",{"aria-labelledby":g.value,role:"dialog",id:w.id,class:"fr-modal"},[t("div",_o,[t("div",po,[t("div",bo,[t("div",vo,[t("div",go,[t("button",{class:"fr-btn--close fr-btn",title:e(r)("Close the modal dialog"),"aria-controls":w.id},o(e(r)("Close")),9,ho)]),t("form",{onSubmit:le(_,["prevent"])},[t("div",yo,[t("h1",{id:g.value,class:"fr-modal__title fr-mb-2w"},o(e(r)("Add member to the organization")),9,$o),n(Ge,{placeholder:w.$t("Search a user"),searchPlaceholder:w.$t("Search a user..."),suggestUrl:"/users/suggest/",values:d.value,onChange:y[0]||(y[0]=A=>d.value=A),allOption:w.$t("Select a user"),addAllOption:!1,onSuggest:v,roundedImages:!0},null,8,["placeholder","searchPlaceholder","values","allOption"]),w.roles.length>0?(c(),S(Se,{key:0,label:e(r)("Role of the member"),"model-value":p.value,"onUpdate:modelValue":y[1]||(y[1]=A=>p.value=A),options:w.roles},null,8,["label","model-value","options"])):R("",!0)]),t("div",wo,[t("div",ko,[t("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500",type:"button",onClick:f,disabled:l.value},o(e(r)("Cancel")),9,zo),t("button",{class:"fr-btn",type:"submit",disabled:l.value},o(e(r)("Add to the organization")),9,Ao)])])],32)])])])])],8,mo)]))}}),So=["aria-controls"],Do=T({__name:"AdminAddMemberButton",props:{oid:{},roles:{}},emits:["memberAdded"],setup(m){const s=m,{t:a}=M(),b=F(()=>"fr-modal-add-user-"+s.oid);return(r,i)=>(c(),h(B,null,[t("button",{class:"fr-btn fr-btn--sm fr-btn--icon-left fr-icon-add-line","data-fr-opened":"false","aria-controls":b.value},o(e(a)("Add member")),9,So),n(Co,{id:b.value,oid:r.oid,roles:r.roles,onMemberAdded:i[0]||(i[0]=l=>r.$emit("memberAdded"))},null,8,["id","oid","roles"])],64))}}),Ro={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle"},Me=T({__name:"AdminDangerZone",setup(m){return(s,a)=>(c(),S(e(st),{color:"error",type:"secondary",weight:"regular"},{default:u(()=>[t("div",Ro,[H(s.$slots,"default")])]),_:3}))}}),To={class:"fr-px-1v rounded-2 monospace fr-text--sm text-mention-grey bg-grey-100 fr-m-0"},Be=T({__name:"AdminEmail",props:{email:{}},setup(m){return(s,a)=>(c(),h("p",To,o(s.email),1))}}),qo=["aria-labelledby","id"],Mo={class:"fr-container fr-container--fluid fr-container-md"},Bo={class:"fr-grid-row fr-grid-row--center"},Po={class:"fr-col-12 fr-col-md-8"},Oo={class:"fr-modal__body"},Io={class:"fr-modal__header"},Fo=["title","aria-controls"],Lo={class:"fr-modal__content"},jo=["id"],Uo={class:"fr-grid-row fr-grid-row--middle fr-mb-2w"},Ho={class:"fr-text--bold fr-m-0 fr-mr-1v"},Vo={class:"fr-col"},Eo={class:"fr-col-auto"},No=["disabled"],xo={class:"fr-col"},Wo={class:"fr-m-0 text-grey-500"},Yo={class:"fr-m-0 fr-text--xs text-default-error"},Jo={class:"fr-col-auto"},Zo=["disabled"],Ko=T({__name:"AdminEditMemberModal",props:{id:{},member:{},oid:{},roles:{}},emits:["memberUpdated"],setup(m,{emit:s}){const a=m,b=s,r=F(()=>"fr-modal-title-user-"+a.id),{t:i}=M(),{toast:l}=ce(),d=z(!1);async function p(f){if(!f.newRole){v();return}try{d.value=!0,await ot(a.oid,f.user.id,f.newRole),b("memberUpdated"),v()}catch(w){l.error(i("An error occurred while update member role."))}finally{d.value=!1}}async function g(f){try{d.value=!0,await at(a.oid,f.user.id),b("memberUpdated")}catch(w){l.error(i("An error occurred while removing this member."))}finally{d.value=!1}}function _(f){return a.roles.map(w=>{const y={...w};return y.value===f&&(y.selected=!0),y})}function v(){d.value=!1;const f=document.getElementById(a.id);globalThis.dsfr(f).modal.conceal()}return(f,w)=>(c(),S(ie,{to:"body"},[t("dialog",{"aria-labelledby":r.value,role:"dialog",id:f.id,class:"fr-modal"},[t("div",Mo,[t("div",Bo,[t("div",Po,[t("div",Oo,[t("div",Io,[t("button",{class:"fr-btn--close fr-btn",title:e(i)("Close the modal dialog"),"aria-controls":f.id},o(e(i)("Close")),9,Fo)]),t("div",Lo,[t("h1",{id:r.value,class:"fr-modal__title fr-mb-2w"},o(e(i)("Edit member")),9,jo),t("div",Uo,[n(e(de),{class:"fr-mr-1v",user:f.member.user,rounded:!0,size:24},null,8,["user"]),t("p",Ho,o(f.member.user.first_name)+" "+o(f.member.user.last_name),1),f.member.user.email?(c(),S(Be,{key:0,email:f.member.user.email},null,8,["email"])):R("",!0)]),t("form",{class:"fr-grid-row fr-grid-row--gutters fr-grid-row--bottom",onSubmit:w[1]||(w[1]=le(y=>p(f.member),["prevent"]))},[t("div",Vo,[f.roles.length>0?(c(),S(Se,{key:0,label:e(i)("Role of the member"),"model-value":f.member.role,"onUpdate:modelValue":w[0]||(w[0]=y=>f.member.newRole=y),options:_(f.member.role)},null,8,["label","model-value","options"])):R("",!0)]),t("div",Eo,[t("button",{class:"fr-btn",type:"submit",disabled:d.value},o(e(i)("Validate")),9,No)])],32),n(Me,{class:"fr-mt-2w"},{default:u(()=>[t("div",xo,[t("p",Wo,o(e(i)("Remove member from the organization")),1),t("p",Yo,o(e(i)("Be careful, this action can't be reverse.")),1)]),t("div",Jo,[t("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary--error fr-btn--icon-left fr-icon-logout-box-r-line",disabled:d.value,onClick:w[2]||(w[2]=y=>g(f.member))},o(e(i)("Remove member")),9,Zo)])]),_:1})])])])])])],8,qo)]))}}),Qo=["aria-controls"],Xo=T({__name:"AdminEditMemberButton",props:{member:{},oid:{},roles:{}},emits:["memberUpdated"],setup(m){const s=m,{t:a}=M(),b=F(()=>"fr-modal-user-"+s.member.user.id);return(r,i)=>(c(),h(B,null,[t("button",{class:"fr-btn fr-btn--sm fr-btn--secondary-grey-500 fr-btn--tertiary-no-outline fr-icon-pencil-line","data-fr-opened":"false","aria-controls":b.value},o(e(a)("Edit")),9,Qo),n(Ko,{id:b.value,member:r.member,oid:r.oid,roles:r.roles,onMemberUpdated:i[0]||(i[0]=l=>r.$emit("memberUpdated"))},null,8,["id","member","oid","roles"])],64))}}),Go={class:"fr-mt-n9v fr-mb-2w"},ea={class:"fr-badge fr-badge--info fr-badge--no-icon"},ta={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle"},sa={class:"fr-col"},oa={class:"fr-grid-row fr-grid-row--middle"},aa={class:"fr-text--bold fr-m-0 fr-mr-1v"},na={class:"fr-m-0"},la={class:"fr-ml-3v fr-mt-1-5v fr-mb-0 filet filet-default-grey fr-text--sm"},ra={key:0,class:"fr-col-auto fr-grid-row flex-direction-column"},ia=["disabled"],da=["disabled","aria-controls"],ua=["aria-labelledby","id"],ca={class:"fr-container fr-container--fluid fr-container-md"},fa={class:"fr-grid-row fr-grid-row--center"},ma={class:"fr-col-12 fr-col-md-8"},_a={class:"fr-modal__body"},pa={class:"fr-modal__header"},ba=["title","aria-controls"],va={class:"fr-modal__content"},ga=["id"],ha={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--right"},ya={class:"fr-col-auto"},$a=["disabled"],wa={class:"fr-col-auto"},ka=["disabled"],za=T({__name:"AdminMembershipRequest",props:{loading:{type:Boolean},oid:{},request:{},showActions:{type:Boolean}},emits:["accept","refuse"],setup(m,{emit:s}){const a=m,b=s,{t:r}=M(),i=z(""),l=x("modal"),d=x("modalTitle");function p(){const v=document.getElementById(l);globalThis.dsfr(v).modal.conceal()}function g(){b("refuse",a.request.id,i.value),p()}function _(){i.value="",p()}return(v,f)=>{const w=P("AdminMembershipRequest",!0);return c(),S(W,{class:"drop-shadow rounded-xxs fr-mt-3w"},{default:u(()=>[t("div",Go,[t("p",ea,[f[2]||(f[2]=t("span",{class:"fr-icon-user-add-line fr-icon--sm","aria-hidden":"true"},null,-1)),$(" "+o(e(r)("Membership Request")),1)])]),t("div",ta,[t("div",sa,[t("div",oa,[n(e(de),{class:"fr-mr-1v",user:v.request.user,rounded:!0,size:24},null,8,["user"]),t("p",aa,o(v.request.user.first_name)+" "+o(v.request.user.last_name),1),v.request.user.email?(c(),S(Be,{key:0,email:v.request.user.email,class:"fr-mr-1v"},null,8,["email"])):R("",!0),t("p",na,o(e(r)("asks to join the organization.")),1)]),t("div",la,o(v.request.comment),1)]),v.showActions?(c(),h("div",ra,[t("button",{class:"fr-btn fr-btn--sm fr-btn--icon-left fr-mb-1w fr-icon-check-line",onClick:f[0]||(f[0]=y=>v.$emit("accept",v.request.id)),disabled:v.loading,"data-testid":"accept"},o(e(r)("Accept request")),9,ia),t("button",{class:"fr-btn fr-btn--icon-left fr-btn--sm fr-btn--secondary fr-btn--secondary--error fr-icon-close-line",disabled:v.loading,"data-fr-opened":"false","aria-controls":e(l),"data-testid":"refuse"},o(e(r)("Refuse")),9,da),(c(),S(ie,{to:"body"},[t("dialog",{"aria-labelledby":e(d),role:"dialog",id:e(l),class:"fr-modal","data-testid":"modal"},[t("div",ca,[t("div",fa,[t("div",ma,[t("div",_a,[t("div",pa,[t("button",{class:"fr-btn--close fr-btn",title:e(r)("Close the modal dialog"),"aria-controls":e(l),onClick:le(_,["prevent"])},o(e(r)("Close")),9,ba)]),t("div",va,[t("h1",{id:e(d),class:"fr-modal__title fr-mb-2w"},o(e(r)("Refuse membership request")),9,ga),n(w,{class:"fr-mt-4w fr-mb-2w",loading:!1,oid:v.oid,request:v.request,"show-actions":!1},null,8,["oid","request"]),t("form",{onSubmit:le(g,["prevent"]),onReset:_},[n(nt,{label:e(r)("You can provide the refusal reason:"),modelValue:i.value,"onUpdate:modelValue":f[1]||(f[1]=y=>i.value=y),"data-testid":"comment-group"},null,8,["label","modelValue"]),t("div",ha,[t("div",ya,[t("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500",type:"reset",disabled:v.loading,"data-testid":"cancel-modal-button"},o(e(r)("Cancel")),9,$a)]),t("div",wa,[t("button",{class:"fr-btn",type:"submit",disabled:v.loading,"data-testid":"refuse-modal-button"},o(e(r)("Refuse request")),9,ka)])])],32)])])])])])],8,ua)]))])):R("",!0)])]),_:1})}}}),Aa={key:0},Ca={class:"fr-breadcrumb__link","aria-current":"page"},Sa={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle justify-center"},Da={class:"fr-col-12 fr-col-md"},Ra={class:"fr-h3 fr-mb-0"},Ta={key:0,class:"fr-col-auto"},qa={class:"subtitle subtitle--uppercase fr-mt-5v fr-mb-0"},Ma={class:"fr-text--bold fr-m-0"},Ba={class:"fr-m-0 fr-text--xs text-mention-grey f-italic inline-flex items-center"},Pa={key:0},Oa={key:1},Ia={key:0},Fa=T({__name:"Members",props:{oid:{}},setup(m){const s=m;pe(lt);const{t:a}=M(),{toast:b}=ce(),r=z([]),i=F(()=>rt||p.value.some(k=>{var C;return k.user.id===((C=Q)==null?void 0:C.id)&&k.role==="admin"})),l=z([]),{currentOrganization:d}=J(),p=z([]),g=z(!1);function _(k){var C,q;return(q=(C=l.value.find(K=>K.value===k))==null?void 0:C.label)!=null?q:k}function v(k){return k==="admin"?"info":"default"}async function f(){g.value=!0,p.value=[];try{const k=await De(s.oid);p.value=k.members}finally{g.value=!1}}async function w(){const k=await he(s.oid);r.value=k}async function y(k){g.value=!0;const C=[];try{await ct(s.oid,k),C.push(w()),C.push(f())}catch(q){b.error(a("An error occurred while accepting this membership."))}finally{Promise.all(C).finally(()=>g.value=!1)}}async function A(k,C){g.value=!0;const q=[];try{await ft(s.oid,k,C),q.push(w()),q.push(f())}catch(K){b.error(a("An error occurred while refusing this membership."))}finally{Promise.all(q).finally(()=>g.value=!1)}}return Z(()=>{i.value&&he(s.oid).then(k=>r.value=k)}),re(()=>{it().then(dt).then(k=>l.value=k),f()}),(k,C)=>{const q=P("router-link"),K=P("TextClamp");return c(),h("div",null,[n(Y,null,{default:u(()=>[t("li",null,[n(q,{class:"fr-breadcrumb__link",to:"/"},{default:u(()=>[$(o(e(a)("Administration")),1)]),_:1})]),e(d)?(c(),h("li",Aa,[n(q,{class:"fr-breadcrumb__link",to:"/"},{default:u(()=>[$(o(e(d).name),1)]),_:1})])):R("",!0),t("li",null,[t("a",Ca,o(e(a)("Members")),1)])]),_:1}),t("div",Sa,[t("div",Da,[t("h1",Ra,o(e(a)("Members")),1)]),i.value?(c(),h("div",Ta,[n(Do,{oid:k.oid,roles:l.value,onMemberAdded:f},null,8,["oid","roles"])])):R("",!0)]),r.value.length?(c(),h(B,{key:0},[t("h2",qa,o(e(a)("{n} requests",{n:r.value.length})),1),(c(!0),h(B,null,N(r.value,O=>(c(),S(za,{class:"fr-mb-4w",key:O.id,loading:g.value,oid:k.oid,request:O,"show-actions":!0,onAccept:y,onRefuse:A},null,8,["loading","oid","request"]))),128))],64)):R("",!0),t("h2",{class:X(["subtitle subtitle--uppercase fr-mb-0",{"fr-mt-n3v":r.value.length,"fr-mt-5v":!r.value.length}])},o(e(a)("{n} members",{n:p.value.length})),3),n(te,{class:"fr-table--layout-fixed",loading:g.value},{default:u(()=>[t("thead",null,[t("tr",null,[n(D,{scope:"col"},{default:u(()=>[$(o(e(a)("Members")),1)]),_:1}),n(D,{scope:"col"},{default:u(()=>[$(o(e(a)("Status")),1)]),_:1}),n(D,{scope:"col"},{default:u(()=>[$(o(e(a)("Member since")),1)]),_:1}),n(D,{scope:"col"},{default:u(()=>[$(o(e(a)("Last connection")),1)]),_:1}),i.value?(c(),S(D,{key:0,scope:"col"},{default:u(()=>[$(o(e(a)("Action")),1)]),_:1})):R("",!0)])]),t("tbody",null,[(c(!0),h(B,null,N(p.value,O=>(c(),h("tr",{key:O.user.id},[t("td",null,[t("p",Ma,o(O.user.first_name)+" "+o(O.user.last_name),1),t("p",Ba,[n(e(be),{height:12,width:12,name:"ri-mail-line"}),n(L,null,{default:u(()=>[n(K,{class:"fr-px-1v",text:O.user.email,"auto-resize":!0,"max-lines":1},null,8,["text"])]),_:2},1024)])]),t("td",null,[n(ne,{type:v(O.role)},{default:u(()=>[$(o(_(O.role)),1)]),_:2},1032,["type"])]),t("td",null,o(e(j)(O.since)),1),t("td",null,[O.user.last_login_at?(c(),h("span",Pa,o(e(ut)(O.user.last_login_at)),1)):(c(),h("span",Oa,o(e(a)("No connection")),1))]),i.value?(c(),h("td",Ia,[n(Xo,{member:O,oid:k.oid,roles:l.value,onMemberUpdated:f},null,8,["member","oid","roles"])])):R("",!0)]))),128))])]),_:1},8,["loading"])])}}}),La={class:"fr-container--fluid"},ja={key:0},Ua={class:"fr-breadcrumb__link","aria-current":"page"},Ha={class:"fr-h3 fr-mb-5v"},Va={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle justify-between"},Ea={class:"fr-col-12 fr-col-md fr-grid-row fr-grid-row--middle"},Na={class:"fr-ml-3v fr-my-0 fr-h3"},xa=["title"],Wa={class:"fr-col-auto"},Ya=["href"],Ja=["id"],Za=["disabled","onClick"],Ka={class:"fr-col"},Qa={class:"fr-m-0 text-grey-500"},Xa={class:"fr-m-0 fr-text--xs text-default-error"},Ga={class:"fr-col-auto"},en=["disabled","aria-controls"],tn=["aria-labelledby","id"],sn={class:"fr-container fr-container--fluid fr-container-md"},on={class:"fr-grid-row fr-grid-row--center"},an={class:"fr-col-12 fr-col-md-8"},nn={class:"fr-modal__body"},ln={class:"fr-modal__header"},rn=["title","aria-controls"],dn={class:"fr-modal__content"},un=["id"],cn={class:"fr-text--bold"},fn={class:"fr-modal__footer"},mn={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-reverse fr-btns-group--inline-lg fr-btns-group--icon-left"},_n=["disabled"],pn=T({__name:"Profile",props:{oid:{}},setup(m){const{t:s}=M(),{toast:a}=ce(),b=m,r=Ce(),i=z(null),{currentOrganization:l}=J(),d=z(null),{organizationCertified:p}=mt(d),g=z([]),_=z(!1),v=x("modal"),f=x("modalTitle");function w(){l.value&&(_.value=!0,bt(l.value.id).then(()=>{r.replace("/"),window.location.reload()}).catch(()=>a.error(s("An error occured when deleting the organization."))).finally(()=>_.value=!1))}async function y(A,k){_.value=!0;try{d.value=await vt(A),a.success(s("Organization updated !"))}catch(C){a.error(s("An error occured when updating the organization."))}finally{_.value=!1}if(k&&d.value){_.value=!0;try{const C=await gt(d.value.id,k);d.value.logo_thumbnail=C.image}catch(C){a.error(s("Failed to upload logo, you can upload it again in your management panel"))}finally{_.value=!1}}}return re(async()=>{_.value=!0;try{d.value=await De(b.oid)}finally{_.value=!1}}),(A,k)=>{const C=P("router-link");return c(),h("div",La,[n(Y,null,{default:u(()=>[t("li",null,[n(C,{class:"fr-breadcrumb__link",to:"/"},{default:u(()=>[$(o(e(s)("Administration")),1)]),_:1})]),e(l)?(c(),h("li",ja,[n(C,{class:"fr-breadcrumb__link",to:"/"},{default:u(()=>[$(o(e(l).name),1)]),_:1})])):R("",!0),t("li",null,[t("a",Ua,o(e(s)("Profile")),1)])]),_:1}),t("h1",Ha,o(e(s)("Profile")),1),d.value?(c(),S(W,{key:0,class:"fr-mb-5v"},{default:u(()=>[t("div",Va,[t("div",Ea,[n(e(_t),{src:d.value.logo,type:"organization",size:80,class:"rounded-xxs border"},null,8,["src"]),t("div",Na,[$(o(d.value.name)+" ",1),e(p)?(c(),h("span",{key:0,class:"fr-icon-success-line fr-icon--lg text-blue-400",title:e(s)("The identity of this public service is certified by {certifier}",{certifier:e(ve)}),"aria-hidden":"true"},null,8,xa)):R("",!0)])]),t("div",Wa,[t("a",{href:d.value.page,class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 fr-btn--icon-left fr-icon-eye-line"},o(e(s)("See the organization page")),9,Ya)])])]),_:1})):R("",!0),i.value?(c(),h("h2",{key:1,class:"subtitle subtitle--uppercase fr-mb-5v",id:i.value.legend},o(e(s)("Edit profile")),9,Ja)):R("",!0),_.value&&!d.value?(c(),S(qe,{key:2})):R("",!0),d.value?(c(),S(pt,{key:3,organization:d.value,errors:g.value,showLegend:!1,showWell:!1,ref_key:"form",ref:i,onSubmit:y},{submitButton:u(({submit:q})=>[t("button",{class:"fr-btn fr-btn--icon-left fr-icon-save-line",disabled:_.value,"data-testid":"submitButton",onClick:q},o(e(s)("Save")),9,Za)]),default:u(()=>[n(Me,{class:"fr-mt-6w"},{default:u(()=>[t("div",Ka,[t("p",Qa,o(e(s)("Delete the organization")),1),t("p",Xa,o(e(s)("Be careful, this action can't be reverse.")),1)]),t("div",Ga,[t("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary--error fr-btn--icon-left fr-icon-delete-line",disabled:_.value,"data-fr-opened":"false","aria-controls":e(v)},o(e(s)("Delete")),9,en),(c(),S(ie,{to:"body"},[t("dialog",{"aria-labelledby":e(f),role:"dialog",id:e(v),class:"fr-modal"},[t("div",sn,[t("div",on,[t("div",an,[t("div",nn,[t("div",ln,[t("button",{class:"fr-btn--close fr-btn",title:e(s)("Close the modal dialog"),"aria-controls":e(v)},o(e(s)("Close")),9,rn)]),t("div",dn,[t("h1",{id:e(f),class:"fr-modal__title fr-mb-2w"},o(e(s)("Are you sure you want to delete this organization ?")),9,un),t("p",cn,o(e(s)("This action can't be reverse.")),1),t("p",null,o(e(s)("All content published with this organization will stay online, with the same URL but in an anonymous form, i.e. without being linked to a data producer.")),1),t("p",null,o(e(s)("If you want to delete your published content too, start by deleting the contents before deleting your account.")),1)]),t("div",fn,[t("div",mn,[t("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary--error",role:"button",disabled:_.value,onClick:w},o(e(s)("Delete")),9,_n)])])])])])])],8,tn)]))])]),_:1})]),_:1},8,["organization","errors"])):R("",!0)])}}});async function bn(m){return(await ae.get("posts/".concat(m,"/"))).data}async function vn(m){return(await ae.get("dataservices/".concat(m,"/"))).data}pe(wt,$t,yt,ht);async function gn(m,s,a,b){return(await ae.get(Re("discussions/"),{params:{org:m,sort:b,page_size:a,page:s}})).data}async function hn(m){switch(m.class){case"Dataservice":return vn(m.id);case"Dataset":return zt(m.id);case"Post":return bn(m.id);case"Reuse":return kt(m.id);default:return null}}function yn(m,s){return m===null?null:{title:$n(m),icon:kn(s),page:wn(m)}}function $n(m){return m===null?"":"title"in m?m.title:"headline"in m?m.headline:Te(m,"Unknown type ".concat(m))}function wn(m){return m===null?"":"page"in m?m.page:"self_web_url"in m?m.self_web_url:Te(m,"Unknown type ".concat(m))}function kn(m){switch(m){case"Dataservice":return"ri-terminal-line";case"Dataset":return"ri-database-2-line";case"Post":return"ri-article-line";case"Reuse":return"ri-line-chart-line";default:return""}}const zn={class:"fr-text--bold"},An={key:0},Cn=["href"],Sn={class:"inline-flex items-center"},Dn=["href"],Rn=T({__name:"AdminDiscussionsTable",props:{discussions:{},loading:{type:Boolean},sortDirection:{},sortedBy:{}},emits:["sort"],setup(m){const s=m,{t:a}=M(),b=z({}),r=z({});Z(async()=>{for(const p of s.discussions)if(!(p.subject.id in b.value)){const g=hn(p.subject);b.value[p.subject.id]=g;const _=await b.value[p.subject.id];r.value[p.subject.id]=yn(_,p.subject.class)}});function i(p,g){return g?g.page+"#/discussions/"+p:""}function l(p){return s.sortedBy===p?s.sortDirection:null}function d(p){return p.discussion.slice(-1)[0]}return(p,g)=>(c(),S(te,{class:"fr-table--layout-fixed",loading:p.loading},{default:u(()=>[t("thead",null,[n(D,{onSort:g[0]||(g[0]=_=>p.$emit("sort","title",_)),sorted:l("title"),scope:"col"},{default:u(()=>[$(o(e(a)("Discussion")),1)]),_:1},8,["sorted"]),n(D,{scope:"col"},{default:u(()=>[$(o(e(a)("Number of comments")),1)]),_:1}),n(D,{scope:"col"},{default:u(()=>[$(o(e(a)("Last comment")),1)]),_:1}),n(D,{onSort:g[1]||(g[1]=_=>p.$emit("sort","closed",_)),sorted:l("closed"),scope:"col"},{default:u(()=>[$(o(e(a)("Closed at")),1)]),_:1},8,["sorted"]),n(D,{scope:"col",style:{width:"25%"}},{default:u(()=>[$(o(e(a)("Link to the discussion")),1)]),_:1})]),t("tbody",null,[(c(!0),h(B,null,N(p.discussions,_=>{var v,f,w;return c(),h("tr",null,[t("td",null,[t("p",zn,[n(e(E),{text:_.title,"auto-resize":!0,"max-lines":1},null,8,["text"])]),r.value[_.subject.id]?(c(),h("p",An,[t("a",{class:"fr-link inline-flex",href:(v=r.value[_.subject.id])==null?void 0:v.page},[n(e(be),{height:12,class:"self-center",name:(f=r.value[_.subject.id])==null?void 0:f.icon},null,8,["name"]),n(e(E),{class:"overflow-wrap-anywhere",text:(w=r.value[_.subject.id])==null?void 0:w.title,"auto-resize":!0,"max-lines":1},null,8,["text"])],8,Cn)])):R("",!0)]),t("td",null,o(_.discussion.length),1),t("td",null,[t("div",null,[t("p",null,o(e(j)(d(_).posted_on)),1),t("p",Sn,[$(o(e(a)("by "))+" ",1),n(e(jt),{class:"fr-ml-1v",user:d(_).posted_by},null,8,["user"])])])]),t("td",null,[_.closed?(c(),h(B,{key:0},[$(o(e(j)(_.closed)),1)],64)):R("",!0)]),t("td",null,[r.value[_.subject.id]?(c(),h("a",{key:0,class:"fr-link inline-flex",href:i(_.id,r.value[_.subject.id]),target:"_blank"},[n(e(E),{text:i(_.id,r.value[_.subject.id]),"auto-resize":!0,"max-lines":1},null,8,["text"])],8,Dn)):R("",!0)])])}),256))])]),_:1},8,["loading"]))}}),Tn="/_themes/gouvfr/assets/discussion.svg",qn={class:"fr-container--fluid"},Mn={key:0},Bn={class:"fr-breadcrumb__link","aria-current":"page"},Pn={class:"fr-h3 fr-mb-5v"},On={class:"subtitle subtitle--uppercase fr-m-0"},In={class:"text-align-center fr-py-1w"},Fn=["src"],Ln={class:"fr-text--bold fr-my-3v"},jn=T({__name:"Discussions",props:{oid:{}},setup(m){const{t:s}=M(),a=m,b=z(!1),r=z(1),i=z(10),l=z(0),d=z("created"),p=z("desc"),g=F(()=>"".concat(p.value==="asc"?"":"-").concat(d.value)),_=z([]),{currentOrganization:v}=J();function f(w,y){d.value=w,p.value=y}return Z(async()=>{b.value=!0,_.value=[];try{const w=await gn(a.oid,r.value,i.value,g.value);_.value=w.data,r.value=w.page,i.value=w.page_size,l.value=w.total}finally{b.value=!1}}),(w,y)=>{const A=P("router-link");return c(),h("div",qn,[n(Y,null,{default:u(()=>[t("li",null,[n(A,{class:"fr-breadcrumb__link",to:"/"},{default:u(()=>[$(o(e(s)("Administration")),1)]),_:1})]),e(v)?(c(),h("li",Mn,[n(A,{class:"fr-breadcrumb__link",to:"/"},{default:u(()=>[$(o(e(v).name),1)]),_:1})])):R("",!0),t("li",null,[t("a",Bn,o(e(s)("Discussions")),1)])]),_:1}),t("h1",Pn,o(e(s)("Discussions")),1),t("h2",On,o(e(s)("{n} discussions",l.value)),1),b.value||l.value>0?(c(),S(Rn,{key:0,discussions:_.value,loading:b.value,"sort-direction":p.value,sortedBy:d.value,onSort:f},null,8,["discussions","loading","sort-direction","sortedBy"])):(c(),S(W,{key:1,class:"fr-my-2w"},{default:u(()=>[t("div",In,[t("img",{src:e(Tn),alt:"",loading:"lazy"},null,8,Fn),t("p",Ln,o(e(s)("There is no discussion yet")),1)])]),_:1})),l.value>i.value?(c(),S(e(oe),{key:2,page:r.value,"page-size":i.value,"total-results":l.value,onChange:y[0]||(y[0]=k=>r.value=k)},null,8,["page","page-size","total-results"])):R("",!0)])}}});async function Un(m,s,a){return(await ae.get(Re("harvest/sources/"),{params:{owner:m,deleted:!0,page:s,page_size:a}})).data}const Hn="/_themes/gouvfr/assets/harvester.svg",Vn={class:"fr-container--fluid"},En={key:0},Nn={class:"fr-breadcrumb__link","aria-current":"page"},xn={class:"fr-h3 fr-mb-5v"},Wn={class:"subtitle subtitle--uppercase fr-m-0"},Yn=["href"],Jn={class:"text-align-center fr-py-1w"},Zn=["src"],Kn={class:"fr-text--bold fr-my-3v"},Qn=T({__name:"Harvesters",props:{oid:{}},setup(m){const{t:s}=M(),a=m,b=z(!1),r=z(1),i=z(10),l=z(0),d=z([]),p=z({}),{currentOrganization:g}=J();function _(y){return"".concat(ee,"harvester/").concat(y.id,"/")}function v(y){return!y.last_job||!p.value[y.last_job.id]?0:p.value[y.last_job.id].items.filter(A=>A.dataservice).length}function f(y){return!y.last_job||!p.value[y.last_job.id]?0:p.value[y.last_job.id].items.filter(A=>A.dataset).length}function w(y){var A;switch((A=y.last_job)==null?void 0:A.status){case"pending":return{label:s("Pending"),type:"default"};case"initializing":return{label:s("Initializing"),type:"info"};case"initialized":return{label:s("Initialized"),type:"default"};case"processing":return{label:s("Processing"),type:"info"};case"done":return{label:s("Done"),type:"success"};case"done-errors":return{label:s("Done with errors"),type:"warning"};case"failed":return{label:s("Failed"),type:"error"};default:return{label:s("No job yet"),type:"default"}}}return Z(async()=>{var y;b.value=!0,d.value=[];try{const A=await Un(a.oid,r.value,i.value);d.value=A.data,r.value=A.page,i.value=A.page_size,l.value=A.total;const k=[];for(const q of d.value)(y=q.last_job)!=null&&y.id&&k.push(ae.get("harvest/job/".concat(q.last_job.id,"/")));const C=await Promise.allSettled(k);for(const q of C)q.status==="fulfilled"&&(p.value[q.value.data.id]=q.value.data)}finally{b.value=!1}}),(y,A)=>{const k=P("router-link");return c(),h("div",Vn,[n(Y,null,{default:u(()=>[t("li",null,[n(k,{class:"fr-breadcrumb__link",to:"/"},{default:u(()=>[$(o(e(s)("Administration")),1)]),_:1})]),e(g)?(c(),h("li",En,[n(k,{class:"fr-breadcrumb__link",to:"/"},{default:u(()=>[$(o(e(g).name),1)]),_:1})])):R("",!0),t("li",null,[t("a",Nn,o(e(s)("Harvesters")),1)])]),_:1}),t("h1",xn,o(e(s)("Harvesters")),1),t("h2",Wn,o(e(s)("{n} harvesters",l.value)),1),b.value||l.value?(c(),S(te,{key:0,loading:b.value},{default:u(()=>[t("thead",null,[n(D,{scope:"col"},{default:u(()=>[$(o(e(s)("Name")),1)]),_:1}),n(D,{scope:"col"},{default:u(()=>[$(o(e(s)("Status")),1)]),_:1}),n(D,{scope:"col"},{default:u(()=>[$(o(e(s)("Created at")),1)]),_:1}),n(D,{scope:"col"},{default:u(()=>[$(o(e(s)("Last run")),1)]),_:1}),n(D,{scope:"col"},{default:u(()=>[$(o(e(s)("Datasets")),1)]),_:1}),n(D,{scope:"col"},{default:u(()=>[$(o(e(s)("Dataservices")),1)]),_:1})]),t("tbody",null,[(c(!0),h(B,null,N(d.value,C=>{var q;return c(),h("tr",null,[t("td",null,[n(fe,null,{default:u(()=>[t("a",{class:"fr-link fr-reset-link",href:_(C)},[n(e(E),{text:C.name,"auto-resize":!0,"max-lines":2},null,8,["text"])],8,Yn)]),_:2},1024)]),t("td",null,[n(ne,{type:w(C).type},{default:u(()=>[$(o(w(C).label),1)]),_:2},1032,["type"])]),t("td",null,o(e(j)(C.created_at)),1),t("td",null,[(q=C.last_job)!=null&&q.ended?(c(),h(B,{key:0},[$(o(e(j)(C.last_job.ended)),1)],64)):(c(),h(B,{key:1},[$(o(e(s)("Not yet")),1)],64))]),t("td",null,o(f(C)),1),t("td",null,o(v(C)),1)])}),256))])]),_:1},8,["loading"])):(c(),S(W,{key:1,class:"fr-my-2w"},{default:u(()=>[t("div",Jn,[t("img",{src:e(Hn),alt:"",loading:"lazy"},null,8,Zn),t("p",Kn,o(e(s)("There is no harvesters yet")),1),n(ge,{type:"harvester"})])]),_:1})),l.value>i.value?(c(),S(e(oe),{key:2,page:r.value,"page-size":i.value,"total-results":l.value,onChange:A[0]||(A[0]=C=>r.value=C)},null,8,["page","page-size","total-results"])):R("",!0)])}}}),Xn=["href"],Gn={key:0},el=["href"],tl={class:"fr-p-1v monospaced bg-grey-100 fr-text--sm text-mention-grey rounded-xxs"},sl=T({__name:"AdminCommunityResourcesTable",props:{communityResources:{},loading:{type:Boolean},sortedBy:{},sortDirection:{}},emits:["sort"],setup(m){const s=m,{t:a}=M();function b(l){return s.sortedBy===l?s.sortDirection:null}function r(l){return"".concat(ee,"dataset/").concat(l.dataset.id,"/community-resource/").concat(l.id,"/")}function i(l){const d=l.extras&&"check:available"in l.extras;return d&&l.extras["check:available"]===!1?{label:a("Unavailable"),type:"error"}:d?{label:a("Available"),type:"info"}:{label:a("Not checked yet"),type:"default"}}return(l,d)=>{const p=P("Vicon");return c(),S(te,{loading:l.loading},{default:u(()=>[t("thead",null,[n(D,{onSort:d[0]||(d[0]=g=>l.$emit("sort","title",g)),sorted:b("title"),scope:"col"},{default:u(()=>[$(o(e(a)("Resource title")),1)]),_:1},8,["sorted"]),n(D,null,{default:u(()=>[$(o(e(a)("Status")),1)]),_:1}),n(D,null,{default:u(()=>[$(o(e(a)("Format")),1)]),_:1}),n(D,{onSort:d[1]||(d[1]=g=>l.$emit("sort","created_at_internal",g)),sorted:b("created_at_internal"),scope:"col"},{default:u(()=>[$(o(e(a)("Created at")),1)]),_:1},8,["sorted"]),n(D,{onSort:d[2]||(d[2]=g=>l.$emit("sort","last_modified_internal",g)),sorted:b("last_modified_internal"),scope:"col"},{default:u(()=>[$(o(e(a)("Modified at")),1)]),_:1},8,["sorted"])]),t("tbody",null,[(c(!0),h(B,null,N(l.communityResources,g=>{var _,v;return c(),h("tr",null,[t("td",null,[n(fe,{class:"fr-text--bold"},{default:u(()=>[t("a",{class:"fr-link fr-reset-link",href:r(g)},[n(e(E),{text:g.title,"auto-resize":!0,"max-lines":2},null,8,["text"])],8,Xn)]),_:2},1024),l.datasets[g.dataset.id]?(c(),h("p",Gn,[t("a",{class:"fr-link inline-flex",href:(_=l.datasets[g.dataset.id])==null?void 0:_.page},[n(p,{height:12,class:"self-center",name:l.getSubjectTypeIcon("Dataset")},null,8,["name"]),n(e(E),{class:"overflow-wrap-anywhere",text:(v=l.datasets[g.dataset.id])==null?void 0:v.title,"auto-resize":!0,"max-lines":1},null,8,["text"])],8,el)])):R("",!0)]),t("td",null,[n(ne,{type:i(g).type},{default:u(()=>[$(o(i(g).label),1)]),_:2},1032,["type"])]),t("td",null,[t("code",tl,o(g.format),1)]),t("td",null,o(e(j)(g.created_at)),1),t("td",null,o(e(j)(g.last_modified)),1)])}),256))])]),_:1},8,["loading"])}}}),ol={class:"fr-container--fluid"},al={key:0},nl={class:"fr-breadcrumb__link","aria-current":"page"},ll={class:"fr-h3 fr-mb-5v"},rl={class:"subtitle subtitle--uppercase fr-m-0"},il={class:"text-align-center fr-py-1w"},dl=["src"],ul={class:"fr-text--bold fr-my-3v"},Ae=T({__name:"CommunityResources",props:{oid:{}},setup(m){const{t:s}=M(),a=m,b=z([]),r=z(!1),i=z(1),l=z(10),d=z(0),p=z("created_at_internal"),g=z("desc"),_=F(()=>"".concat(g.value==="asc"?"":"-").concat(p.value)),{currentOrganization:v}=J(),f=ue();function w(y,A){p.value=y,g.value=A}return Z(async()=>{r.value=!0,b.value=[];try{let y;if(a.oid)y=await At(a.oid,i.value,l.value,_.value);else if(f.value)y=await Ct(f.value.id,i.value,l.value,_.value);else return;b.value=y.data,i.value=y.page,l.value=y.page_size,d.value=y.total}finally{r.value=!1}}),(y,A)=>{const k=P("router-link");return c(),h("div",ol,[n(Y,null,{default:u(()=>[t("li",null,[n(k,{class:"fr-breadcrumb__link",to:"/"},{default:u(()=>[$(o(e(s)("Administration")),1)]),_:1})]),e(v)?(c(),h("li",al,[n(k,{class:"fr-breadcrumb__link",to:"/"},{default:u(()=>[$(o(e(v).name),1)]),_:1})])):R("",!0),t("li",null,[t("a",nl,o(e(s)("Community Resources")),1)])]),_:1}),t("h1",ll,o(e(s)("Community Resources")),1),t("h2",rl,o(e(s)("{n} community resources",b.value.length)),1),r.value||d.value>0?(c(),S(sl,{key:0,"community-resources":b.value,loading:r.value,sortDirection:g.value,sortedBy:p.value,onSort:w},null,8,["community-resources","loading","sortDirection","sortedBy"])):(c(),S(W,{key:1,class:"fr-mt-1w fr-mb-2w"},{default:u(()=>[t("div",il,[t("img",{src:e(St),alt:"",loading:"lazy"},null,8,dl),t("p",ul,o(e(s)("You haven't published a community resource yet")),1)])]),_:1})),d.value>l.value?(c(),S(e(oe),{key:2,page:i.value,"page-size":l.value,"total-results":d.value,onChange:A[0]||(A[0]=C=>i.value=C)},null,8,["page","page-size","total-results"])):R("",!0)])}}});Dt({admin_root:ee,default_lang:me.global.locale.value,only_locales:me.global.locale.value,schema_documentation_url:Rt,schema_validata_url:Tt,show_copy_resource_permalink:!0,tabular_api_url:qt,tabular_page_size:Mt,title:ve});const cl=[{path:"/me",children:[{path:"",component:Ns,name:"me"},{path:"datasets",component:$e,name:"me-datasets"},{path:"reuses",component:we,name:"me-reuses"},{path:"community-resources",component:Ae,name:"me-community-resources"}]},{path:"/organizations/:oid",children:[{path:"datasets",component:$e,props:!0,name:"organization-datasets"},{path:"reuses",component:we,props:!0,name:"organization-reuses"},{path:"discussions",component:jn,props:!0,name:"organization-discussions"},{path:"members",component:Fa,props:!0,name:"organization-members"},{path:"harvesters",component:Qn,props:!0,name:"organization-harvesters"},{path:"community-resources",component:Ae,props:!0,name:"organization-community-resources"},{path:"profile",component:pn,props:!0,name:"organization-profile"}]}],fl=Bt({history:Pt(),routes:cl}),se=Ie(fo);Ot(se);se.use(It);se.use(Ft);se.use(me);se.use(fl);se.mount("#admin");globalThis.dsfr.start();console.log("JS is injected !");export{ml as __vite_legacy_guard};
